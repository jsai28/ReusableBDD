feature_file,scenario,step_num,step_name,glue_code,glue_code_file,language
cache.feature,Default Cache directory,1,"I have an ""index.md"" page that contains ""{{ site.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,2,"I have a configuration file with ""title"" set to ""Hello World""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,5,the .jekyll-cache directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,6,the .jekyll-cache/Jekyll/Cache/Jekyll--Cache directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Default Cache directory,8,"I should see ""<p>Hello World</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,1,"I have an ""index.md"" page that contains ""{{ site.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,2,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,5,the .foo-cache directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,6,the .foo-cache/Jekyll/Cache/Jekyll--Cache directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,7,the .jekyll-cache directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Custom Cache directory,9,"I should see ""<p>Hello World</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,1,"I have an ""index.md"" page that contains ""{{ site.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,2,"I have a configuration file with ""title"" set to ""Hello World""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,3,I run jekyll build --safe,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,5,the .jekyll-cache directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Disk usage in safe mode,7,"I should see ""<p>Hello World</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,1,"I have an ""index.md"" page that contains ""{{ site.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,2,"I have a configuration file with ""title"" set to ""Hello World""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,3,I run jekyll build --disable-disk-cache,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,6,"I should see ""<p>Hello World</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
cache.feature,Disabling disk usage in non-safe mode,7,the .jekyll-cache directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,1,"I have an ""index.html"" page that contains ""Collections: {{ site.methods }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,3,"I have a ""_methods/static-file.txt"" file that contains ""Static Content {{ site.title }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,4,"I have a configuration file with ""collections"" set to ""['methods']""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,8,the _site/methods directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,9,"the ""_site/methods/configuration.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection,10,"the ""_site/methods/static-file.txt"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,1,"I have an ""index.html"" page that contains ""Collections: output => {{ site.collections[0].output }} label => {{ site.collections[0].label }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,2,"I have an ""collection_metadata.html"" page that contains ""Methods metadata: {{ site.collections[0].foo }} {{ site.collections[0] }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,3,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,4,"I have a ""_methods/static-file.txt"" file that contains ""Static Content {{ site.title }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,9,"I should see ""Collections: output => true"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,10,"I should see ""label => methods"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,11,"I should see ""Methods metadata: bar"" in ""_site/collection_metadata.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,12,"I should see ""<p>Whatever: foo.bar</p>"" in ""_site/methods/configuration.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection,13,"I should see ""Static Content {{ site.title }}"" in ""_site/methods/static-file.txt""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,1,"I have an ""index.html"" page that contains ""Collections: {{ site.collections }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection at a custom URL,7,"I should see ""<p>Whatever: foo.bar</p>"" in ""_site/methods/configuration/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,1,"I have an ""index.html"" page that contains ""Collections: output => {{ site.collections[0].output }} label => {{ site.collections[0].label }} foo => {{ site.collections[0].foo }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,2,"I have a default layout that contains ""<div class='title'>Tom Preston-Werner</div> {{content}}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,3,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,4,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,8,"I should see ""Collections: output => true"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,9,"I should see ""label => methods"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,10,"I should see ""foo => bar"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,11,"I should see ""<p>Run your generators! default</p>"" in ""_site/methods/site/generate.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered document in a layout,12,"I should see ""<div class='title'>Tom Preston-Werner</div>"" in ""_site/methods/site/generate.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,1,"I have an ""index.html"" page that contains ""Collections: {% for method in site.methods %}{{ method.relative_path }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,7,"I should see ""Collections: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/um_hi.md"" in ""_site/index.html"" unless Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" unless Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).not_to match regexp
    else
      expect(file_contents(file)).to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an array,8,"I should see ""Collections: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/yaml_with_dots.md"" in ""_site/index.html"" if on Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" if on Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).to match regexp
    else
      expect(file_contents(file)).not_to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,1,"I have an ""index.html"" page that contains ""Collections: {% for method in site.methods %}{{ method.relative_path }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,7,"I should see ""Collections: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/um_hi.md"" in ""_site/index.html"" unless Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" unless Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).not_to match regexp
    else
      expect(file_contents(file)).to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Collections specified as an hash,8,"I should see ""Collections: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/yaml_with_dots.md"" in ""_site/index.html"" if on Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" if on Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).to match regexp
    else
      expect(file_contents(file)).not_to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,7,"I should see ""content for Rover"" in ""_site/puppies/rover.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,8,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,9,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,10,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,11,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with document with future date,12,"the ""_site/puppies/fido.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,4,"I have a ""index.html"" page that contains ""Newest puppy: {% assign puppy = site.puppies.last %}{{ puppy.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,8,"I should see ""Newest puppy: Fido"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,9,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,10,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,13,"I should see ""Newest puppy: Fido"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future dated document via Liquid,14,"the ""_site/puppies/fido.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,4,"I have a ""index.md"" page that contains ""{% for puppy in site.puppies %}<div>{{ puppy.title }}</div>{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,8,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,9,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,10,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,11,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,12,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,13,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,14,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,15,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,16,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,17,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,18,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,19,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,20,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,21,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,22,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,23,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,24,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,25,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered and published collection documents via Liquid,26,"the ""_site/puppies/snowy.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,4,"I have a ""foo.txt"" file that contains ""random static file""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,8,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,9,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,10,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Unrendered collection with future dated document,13,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,4,"I have a ""index.html"" page that contains ""Newest puppy: {% assign puppy = site.puppies.last %}{{ puppy.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,8,"I should see ""Newest puppy: Fido"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,9,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,10,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,13,"I should see ""Newest puppy: Fido"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future dated document via Liquid,14,"the ""_site/puppies/fido.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,4,"I have a ""index.md"" page that contains ""{% for puppy in site.puppies %}<div>{{ puppy.title }}</div>{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,8,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,9,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,10,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,11,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,12,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,13,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,14,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,15,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,16,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,17,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,18,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,19,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,20,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,21,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,22,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,23,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,24,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,25,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered but publishable collection documents via Liquid,26,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,4,"I have a ""index.md"" page that contains ""{% for puppy in site.puppies %}<div>{{ puppy.title }}</div>{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,8,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,9,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,10,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,11,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,12,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,13,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,14,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,15,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,16,I run jekyll build --unpublished,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,17,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,18,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,19,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,20,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,21,"I should see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,22,"I should see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,23,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,24,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,25,"the ""_site/puppies/figor.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,26,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,27,I run jekyll build --unpublished --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,28,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,29,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,30,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,31,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,32,"I should see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,33,"I should see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,34,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,35,"the ""_site/puppies/snowy.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,36,"the ""_site/puppies/figor.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access rendered collection with future date and unpublished flag via Liquid,37,"the ""_site/puppies/hardy.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,4,"I have a ""index.md"" page that contains ""{% for puppy in site.puppies %}<div>{{ puppy.title }}</div>{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,8,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,9,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,10,"I should not see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,11,"I should not see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,12,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,13,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,14,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,15,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,16,I run jekyll build --unpublished,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,17,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,18,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,19,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,20,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,21,"I should see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,22,"I should see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,23,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,24,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,25,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,26,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,27,I run jekyll build --unpublished --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,28,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,29,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,30,"I should see ""<div>Rover</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,31,"I should see ""<div>Snowy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,32,"I should see ""<div>Figor</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,33,"I should see ""<div>Hardy</div>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,34,"the ""_site/puppies/rover.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,35,"the ""_site/puppies/snowy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,36,"the ""_site/puppies/figor.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Access unrendered collection with future date and unpublished flag via Liquid,37,"the ""_site/puppies/hardy.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,All the documents,1,"I have an ""index.html"" page that contains ""All documents: {% for doc in site.documents %}{{ doc.relative_path }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,All the documents,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,All the documents,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,All the documents,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,All the documents,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,All the documents,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,All the documents,7,"I should see ""All documents: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/um_hi.md"" in ""_site/index.html"" unless Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" unless Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).not_to match regexp
    else
      expect(file_contents(file)).to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,All the documents,8,"I should see ""All documents: _methods/3940394-21-9393050-fifif1323-test.md _methods/collection/entries _methods/configuration.md _methods/escape-\+ #%20\[\].md _methods/sanitized_path.md _methods/site/generate.md _methods/site/initialize.md _methods/trailing-dots...md _methods/yaml_with_dots.md"" in ""_site/index.html"" if on Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" if on Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).to match regexp
    else
      expect(file_contents(file)).not_to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",1,"I have an ""index.html"" page that contains ""Second document's output: {{ site.documents[2].output }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML",7,"I should see ""Second document's output: <p>Use <code class=\""language-plaintext highlighter-rouge\"">Jekyll.configuration</code> to build a full configuration for use w/Jekyll.</p>\n\n<p>Whatever: foo.bar</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",1,"I have an ""index.html"" page that contains ""Second document's output: {{ site.documents[2].output }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,"Documents have an output attribute, which is the converted HTML based on site.config",7,"I should see ""Second document's output: <p>Use <code>Jekyll.configuration</code> to build a full configuration for use w/Jekyll.</p>\n\n<p>Whatever: foo.bar</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,1,"I have an ""index.html"" page that contains ""{% assign items = site.methods | where: 'whatever','foo.bar' %}Item count: {{ items.size }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Filter documents by where,7,"I should see ""Item count: 2"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by title,1,"I have an ""index.html"" page that contains ""{% assign items = site.methods | sort: 'title' %}2. of {{ items.size }}: {{ items[2].output }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Sort by title,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Sort by title,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort by title,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by title,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Sort by title,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by title,7,"I should see ""2. of 10: <p>Page without title.</p>"" in ""_site/index.html"" unless Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" unless Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).not_to match regexp
    else
      expect(file_contents(file)).to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by title,8,"I should see ""2. of 9: <p>Page without title.</p>"" in ""_site/index.html"" if on Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" if on Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).to match regexp
    else
      expect(file_contents(file)).not_to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,1,"I have an ""index.html"" page that contains ""Collections: {% assign methods = site.methods | sort: 'relative_path' %}{{ methods | map:""title"" | join: "", "" }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,7,"I should see ""Collections: this is a test!, Collection#entries, Jekyll.configuration, Jekyll.escape, Jekyll.sanitized_path, Site#generate, Initialize, Ellipsis Path, Site#generate, YAML with Dots"" in ""_site/index.html"" unless Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" unless Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).not_to match regexp
    else
      expect(file_contents(file)).to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Sort by relative_path,8,"I should see ""Collections: this is a test!, Collection#entries, Jekyll.configuration, Jekyll.escape, Jekyll.sanitized_path, Site#generate, Initialize, Ellipsis Path, YAML with Dots"" in ""_site/index.html"" if on Windows","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)"" if on Windows$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    if Jekyll::Utils::Platforms.really_windows?
      expect(file_contents(file)).to match regexp
    else
      expect(file_contents(file)).not_to match regexp
    end
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,9,"I should see ""Collections: Getting Started, Let's Roll!, Dive-In and Publish Already!, Tip of the Iceberg, Extending with Plugins, Graduation Day"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,11,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,12,"I should see ""Previous: Getting Started"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in all entries,13,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,9,"I should see ""'approx_time' not defined"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,10,"I should see ""Collections: Extending with Plugins, Let's Roll!, Getting Started, Graduation Day, Dive-In and Publish Already!, Tip of the Iceberg"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,11,"I should see ""Previous: Getting Started"" in ""_site/tutorials/graduation-day.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Sort all entries by a Front Matter key defined in only some entries,12,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/graduation-day.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,9,"I should see ""Collections: Getting Started, Tip of the Iceberg, Let's Roll!, Dive-In and Publish Already!, Graduation Day, Extending with Plugins"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,11,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,12,"I should see ""Previous: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort entries,13,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,9,"I should see ""Collections: Getting Started, Let's Roll!, Dive-In and Publish Already!, Graduation Day, Extending with Plugins, Tip of the Iceberg"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,11,"I should not see ""Previous: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,12,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,13,"I should see ""Previous: Getting Started"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Manually sort some entries,14,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,1,"I have an ""index.html"" page that contains ""Collections: {% for method in site.thanksgiving %}{{ method.title }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,2,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,7,"I should see ""Thanksgiving Black Friday"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,8,"I should see ""Happy Thanksgiving"" in ""_site/thanksgiving/2015-11-26-thanksgiving.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with date/dateless filename,9,"I should see ""Black Friday"" in ""_site/thanksgiving/black-friday.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,1,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,2,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with custom permalinks and static file contents,6,"I should see ""I have no front matter."" in ""_site/methods/extensionless_static_file""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,1,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,2,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document,6,"I should see ""I have no file extension but I should still be a part of the collection."" in ""_site/methods/collection/entries""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,1,I have fixture collections,"Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,3,"I have an ""_posts/2019-12-26-extensioned.md"" file that contains ""Hello!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,4,"I have an ""_posts/2019-12-26-extensionless"" file that contains ""Aloha!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,5,"I have an ""index.md"" page that contains ""{{ site.posts | map: 'title' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,6,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,10,"I should see ""I have no file extension but I should still be a part of the collection."" in ""_site/methods/collection/entries""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,11,"I should see ""Extensioned"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections.feature,Rendered collection with an extensionless document in a strict site,12,"I should not see ""Extensionless"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,1,I have a collections/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,2,"I have the following post within the ""collections"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Custom collections_dir containing only posts,7,"I should see ""Random Content."" in ""_site/2009/03/27/gathered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,1,I have a collections/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,2,"I have the following document under the ""puppies"" collection within the ""collections"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,3,I have a collections/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,4,"I have the following post within the ""collections"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing posts,10,"I should see ""Random Content."" in ""_site/2009/03/27/gathered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,1,I have a collections/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,2,"I have the following document under the ""puppies"" collection within the ""collections"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,10,"the ""_site/2009/03/27/post-at-root.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with posts at the site root,11,the _site/_posts directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,1,I have a collections/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,2,"I have the following document under the ""puppies"" collection within the ""collections"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,3,I have a collections/_drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,4,"I have the following draft within the ""collections"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,6,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,10,"I should see ""Random Content."" in ""_site/2009/03/27/gathered-draft.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir also containing drafts,11,the _site/collections directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,1,I have a collections/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,2,"I have the following document under the ""puppies"" collection within the ""collections"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,3,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,4,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,6,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with drafts at the site root,10,"the ""_site/2009/03/27/draft-at-root.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,1,I have a gathering/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,2,I have a gathering/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,3,I have a gathering/_drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,4,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,5,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,6,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,7,"I have the following document under the ""puppies"" collection within the ""gathering"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,8,I have the following document under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,9,"I have the following post within the ""gathering"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,10,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,11,"I have the following draft within the ""gathering"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,12,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,13,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,14,"I have a ""gathering/_puppies/static_file.txt"" file that contains ""Static content.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,15,I have a gathering/_puppies/nested directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,16,"I have a ""gathering/_puppies/nested/static_file.txt"" file that contains ""Nested Static content.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,17,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,18,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,19,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,20,"the ""_site/puppies/rover-in-gathering.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,21,"the ""_site/2009/03/27/post-in-gathering.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,22,"the ""_site/2009/03/27/draft-in-gathering.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,23,"the ""_site/2009/03/27/draft-at-root.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,24,"the ""_site/puppies/rover-at-root.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,25,"I should see exactly ""Static content."" in ""_site/puppies/static_file.txt""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,26,"I should see exactly ""Nested Static content."" in ""_site/puppies/nested/static_file.txt""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,27,the _site/gathering directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,A complex site with collections posts and drafts at various locations,28,the _site/_posts directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,1,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,2,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,10,"I should see ""excerpt for all docs."" in ""_site/puppies/rover.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection with a document that includes a relative document,11,"I should see ""Random Content."" in ""_site/2009/03/27/gathered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,1,I have a collections/_puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,2,"I have the following documents under the ""puppies"" collection within the ""collections"" directory","Given(%r!^I have the following documents? under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,3,I have a collections/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,4,"I have the following post within the ""collections"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,9,"the ""_site/puppies/rover.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,10,"I should see ""excerpt for all docs."" in ""_site/puppies/rover.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Rendered collection in custom collections_dir with a document that includes a relative document,11,"I should see ""Random Content."" in ""_site/2009/03/27/gathered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,1,I have a gathering/_players/managers directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,2,I have a gathering/_players/recruits directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,3,I have a gathering/_players/standby directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,4,"I have the following documents nested inside ""managers"" directory under the ""players"" collection within the ""gathering"" directory","Given(%r!^I have the following documents? nested inside ""(.*)"" directory under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |subdir, label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", subdir, ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,5,"I have the following documents nested inside ""recruits"" directory under the ""players"" collection within the ""gathering"" directory","Given(%r!^I have the following documents? nested inside ""(.*)"" directory under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |subdir, label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", subdir, ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,6,"I have the following documents nested inside ""standby"" directory under the ""players"" collection within the ""gathering"" directory","Given(%r!^I have the following documents? nested inside ""(.*)"" directory under the ""(.*)"" collection within the ""(.*)"" directory:$!) do |subdir, label, dir, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    path = File.join(dir, ""_#{label}"", subdir, ""#{title}.md"")
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,7,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,8,"I have a ""index.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,9,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,10,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,11,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,12,"I should see ""<p>Tony Stark: Manager: true</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,13,"I should see ""<p>Tony Stark: Recruit: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,14,"I should see ""<p>Tony Stark: Villain: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,15,"I should see ""<p>Peter Parker: Manager: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,16,"I should see ""<p>Peter Parker: Recruit: true</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,17,"I should see ""<p>Peter Parker: Villain: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,18,"I should see ""<p>Steve Rogers: Manager: true</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,19,"I should see ""<p>Steve Rogers: Recruit: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,20,"I should see ""<p>Steve Rogers: Villain: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,21,"I should see ""<p>Wanda Maximoff: Manager: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,22,"I should see ""<p>Wanda Maximoff: Recruit: true</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,23,"I should see ""<p>Wanda Maximoff: Villain: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,24,"I should see ""<p>Thanos: Manager: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,25,"I should see ""<p>Thanos: Recruit: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,26,"I should see ""<p>Thanos: Villain: true</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,27,"I should see ""<p>Loki: Manager: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,28,"I should see ""<p>Loki: Recruit: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Front matter defaults and custom collections directory,29,"I should see ""<p>Loki: Villain: false</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,2,"I have fixture collections in ""gathering"" directory","Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,9,"I should see ""Collections: Getting Started, Let's Roll!, Dive-In and Publish Already!, Tip of the Iceberg, Extending with Plugins, Graduation Day"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,11,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,12,"I should see ""Previous: Getting Started"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in all entries,13,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,2,"I have fixture collections in ""gathering"" directory","Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,9,"I should see ""'approx_time' not defined"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,10,"I should see ""Collections: Extending with Plugins, Let's Roll!, Getting Started, Graduation Day, Dive-In and Publish Already!, Tip of the Iceberg"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,11,"I should see ""Previous: Getting Started"" in ""_site/tutorials/graduation-day.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Sort all entries by a Front Matter key defined in only some entries,12,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/graduation-day.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,2,"I have fixture collections in ""gathering"" directory","Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,9,"I should see ""Collections: Getting Started, Tip of the Iceberg, Let's Roll!, Dive-In and Publish Already!, Graduation Day, Extending with Plugins"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,11,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,12,"I should see ""Previous: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort entries,13,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,1,"I have an ""index.html"" page that contains ""Collections: {{ site.tutorials | map: 'title' | join: ', ' }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,2,"I have fixture collections in ""gathering"" directory","Given(%r!^I have fixture collections(?: in ""(.*)"" directory)?$!) do |directory|
  collections_dir = File.join(source_dir, directory.to_s)
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_methods""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_thanksgiving""), collections_dir
  FileUtils.cp_r Paths.source_dir.join(""test"", ""source"", ""_tutorials""), collections_dir
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,4,"I have a ""_layouts/tutorial.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,5,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,9,"I should see ""Collections: Getting Started, Let's Roll!, Dive-In and Publish Already!, Graduation Day, Extending with Plugins, Tip of the Iceberg"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,10,"I should not see ""Previous: Graduation Day"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,11,"I should not see ""Previous: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,12,"I should not see ""Next: Tip of the Iceberg"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,13,"I should see ""Previous: Getting Started"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
collections_dir.feature,Manually sort some entries,14,"I should see ""Next: Dive-In and Publish Already!"" in ""_site/tutorials/lets-roll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,1,"I do not have a ""test_blank"" directory","Given(%r!^I do not have a ""(.*)"" directory$!) do |path|
  Paths.test_dir.join(path).directory?
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,2,I run jekyll new test_blank --blank,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,3,the test_blank/_data directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,4,the test_blank/_drafts directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,5,the test_blank/_includes directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,6,the test_blank/_layouts directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,7,the test_blank/_posts directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,8,the test_blank/_sass directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,9,the test_blank/assets/css directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,10,"the ""test_blank/_layouts/default.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,11,"the ""test_blank/_sass/base.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,12,"the ""test_blank/assets/css/main.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,13,"the ""test_blank/_config.yml"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,14,"the ""test_blank/index.md"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,15,I run jekyll build --source test_blank --destination test_blank/_site,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,16,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,17,the test_blank/_site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,18,"I should see ""Start developing"" in ""test_blank/_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Blank site,19,"I should see ""body {"" in ""test_blank/_site/assets/css/main.css""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site,1,"I have an ""index.html"" file that contains ""Basic Site""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site,5,"I should see ""Basic Site"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with a post,6,"I should see ""My First Exploit"" in ""_site/2009/03/27/hackers.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,2,"I have an ""index.html"" page with layout ""default"" that contains ""Basic Site with Layout""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,3,"I have a default layout that contains ""Page Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a page,7,"I should see ""Page Layout: Basic Site with Layout"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,4,"I have a default layout that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout and a post,8,"I should see ""Post Layout: <p>The only winning move is not to play.</p>"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,4,"I have a post/simple layout that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with layout inside a subfolder and a post,8,"I should see ""Post Layout: <p>The only winning move is not to play.</p>"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",2,"I have a page layout that contains ""Page {{ page.title }}: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",3,"I have a post layout that contains ""Post {{ page.title }}: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",4,"I have an ""index.html"" page with layout ""page"" that contains ""Site contains {{ site.pages.size }} pages and {{ site.posts.size }} posts""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",5,I have a blog directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",6,"I have a ""blog/index.html"" page with layout ""page"" that contains ""blog category index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",7,"I have an ""about.html"" file that contains ""No replacement {{ site.posts.size }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",8,"I have an ""another_file"" file that contains """"","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",9,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",10,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",11,I have a category/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",12,"I have the following posts in ""category""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",13,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",14,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",15,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",16,"I should see ""Page : Site contains 2 pages and 4 posts"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",17,"I should see ""No replacement \{\{ site.posts.size \}\}"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",18,"I should see """" in ""_site/another_file""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",19,"I should see ""Page : blog category index page"" in ""_site/blog/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",20,"I should see ""Post entry1: <p>content for entry1.</p>"" in ""_site/2009/03/27/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",21,"I should see ""Post entry2: <p>content for entry2.</p>"" in ""_site/2009/04/27/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",22,"I should see ""Post entry3: <p>content for entry3.</p>"" in ""_site/category/2009/05/27/entry3.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, pages, posts and files",23,"I should see ""Post entry4: <p>content for entry4.</p>"" in ""_site/category/2009/06/27/entry4.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,2,"I have an ""index.html"" page that contains ""Basic Site with include tag: {% include about.textile %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,3,"I have an ""_includes/about.textile"" file that contains ""Generated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with include tag,7,"I should see ""Basic Site with include tag: Generated by Jekyll"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,2,"I have an ""_includes/about.textile"" file that contains ""Generated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,3,I have an info directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,4,"I have an ""info/index.html"" page that contains ""Basic Site with subdir include tag: {% include about.textile %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with subdir include tag,8,"I should see ""Basic Site with subdir include tag: Generated by Jekyll"" in ""_site/info/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,2,"I have an ""_includes/about.textile"" file that contains ""Generated by {% include jekyll.textile %}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,3,"I have an ""_includes/jekyll.textile"" file that contains ""Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,4,"I have an ""index.html"" page that contains ""Basic Site with include tag: {% include about.textile %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with nested include tag,8,"I should see ""Basic Site with include tag: Generated by Jekyll"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,1,"I have an ""index.html"" page that contains ""URL: {% post_url 2008-01-01-entry2 %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,2,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,4,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with internal post linking,8,"I should see ""URL: /2008/01/01/entry2/"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with whitelisted dotfile,1,"I have an "".htaccess"" file that contains ""SomeDirective""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with whitelisted dotfile,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with whitelisted dotfile,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with whitelisted dotfile,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with whitelisted dotfile,5,"I should see ""SomeDirective"" in ""_site/.htaccess""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,1,"I have a ""test"" file that contains ""some stuff""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,5,"I delete the file ""test""","When(%r!^I delete the file ""(.*)""$!) do |file|
  File.delete(file)
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,6,I have a test directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,7,"I have a ""test/index.html"" file that contains ""some other stuff""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,9,the _site/test directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,File was replaced by a directory,10,"I should see ""some other stuff"" in ""_site/test/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,1,"I have an ""index.html"" page with title ""index"" that contains ""Published page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,2,"I have a ""public.html"" page with published ""true"" that contains ""Explicitly published page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,3,"I have a ""secret.html"" page with published ""false"" that contains ""Unpublished page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,7,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,8,"the ""_site/public.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,9,"the ""_site/secret.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,10,I run jekyll build --unpublished,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,13,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,14,"the ""_site/public.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with unpublished page,15,"the ""_site/secret.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,6,"I should see ""content for entry2"" in ""_site/2007/12/31/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,7,"the ""_site/2040/12/31/entry1.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,8,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,Basic site with page with future date,11,"the ""_site/2040/12/31/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",2,"I have a page layout that contains ""Page {{ page.title }}: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",3,"I have a post layout that contains ""Post {{ page.title }}: {{ content }}Related posts: {{ site.related_posts | size }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",4,"I have an ""index.html"" page with layout ""page"" that contains ""Site contains {{ site.pages.size }} pages and {{ site.posts.size }} posts; Related posts: {{ site.related_posts | size }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",5,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",6,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",10,"I should see ""Page : Site contains 1 pages and 2 posts; Related posts: 0"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",11,"I should see ""Post entry1: <p>content for entry1.</p>\nRelated posts: 1"" in ""_site/2009/03/27/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
create_sites.feature,"Basic site with layouts, posts and related posts",12,"I should see ""Post entry2: <p>content for entry2.</p>\nRelated posts: 1"" in ""_site/2009/04/27/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,2,"I have a ""_data/products.yaml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,3,"I have an ""index.html"" page that contains ""{% for product in site.data.products %}{{product.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,6,"I should see ""sugar"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in _data directory,7,"I should see ""salt"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,2,"I have a ""_data/members.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,3,"I have an ""index.html"" page that contains ""{% for member in site.data.members %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,6,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory,7,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,2,"I have a ""_data/members.json"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,3,"I have an ""index.html"" page that contains ""{% for member in site.data.members %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,6,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.json files in _data directory,7,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,2,"I have a ""_data/members.csv"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,3,"I have an ""index.html"" page that contains ""{% for member in site.data.members %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,6,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.csv files in _data directory,7,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,2,"I have a ""_data/members.tsv"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,3,"I have an ""index.html"" page that contains ""{% for member in site.data.members %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,6,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.tsv files in _data directory,7,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,2,"I have a ""_data/team members.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,3,"I have an ""index.html"" page that contains ""{% for member in site.data.team_members %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,6,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yml files in _data directory with space in file name,7,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,2,I have a _data/categories directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,3,"I have a ""_data/categories/dairy.yaml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,4,"I have an ""index.html"" page that contains ""{{ site.data.categories.dairy.name }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,6,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,autoload *.yaml files in subdirectories in _data directory,7,"I should see ""Dairy Products"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,1,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,2,I have a _data/categories directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,3,"I have a ""_data/categories/dairy.yaml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,4,"I have a ""_data/categories.yaml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,5,"I have an ""index.html"" page that contains ""{{ site.data.categories.dairy.name }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,7,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,folders should have precedence over files with the same name,8,"I should see ""Dairy Products"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,1,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,2,"I have an ""index.html"" page that contains ""{% for member in site.data %}{{member.name}}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,4,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,5,"I should see ""Jack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
data.feature,should be backward compatible with site.data in _config.yml,6,"I should see ""Leon"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,1,"I have a configuration file with ""permalink"" set to ""none""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,2,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,3,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,4,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Preview a draft,7,"I should see ""Not baked yet."" in ""_site/recipe.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,1,"I have a configuration file with ""permalink"" set to ""none""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,2,"I have an ""index.html"" page that contains ""Totally index""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,3,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,4,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft,8,"the ""_site/recipe.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,1,"I have a configuration file with ""permalink"" set to ""none""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,2,"I have an ""index.html"" page that contains ""Totally index""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,3,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,4,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,5,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Don't preview a draft that is not published,8,"the ""_site/recipe.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,1,"I have a configuration file with ""permalink"" set to ""none""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,2,I have a _drafts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,3,I have the following draft,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,4,I run jekyll build --drafts,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
drafts.feature,Use page.path variable,7,"I should see ""Post path: _drafts/recipe.markdown"" in ""_site/recipe.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,4,"I have a default layout that contains ""{{ site.time | date_to_xmlschema }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert date to XML schema,8,"I should see today's date in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should see today's date in ""(.*)""$!) do |file|
  step %(I should see ""#{Date.today}"" in ""#{file}"")
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,4,"I have a default layout that contains ""{{ page.title | xml_escape }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Escape text for XML,8,"I should see ""Star &amp; Wars"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,4,"I have a default layout that contains ""{{ content | number_of_words }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Calculate number of words,8,"I should see ""7"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,4,"I have a default layout that contains ""{{ page.tags | array_to_sentence_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Convert an array into a sentence,8,"I should see ""scifi, movies, and force"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,4,"I have a default layout that contains ""By {{ '_Obi-wan_' | markdownify }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Markdownify a given string,8,"I should see ""By <p><em>Obi-wan</em></p>"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,2,I have the following page,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,3,I have the following page,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,4,"I have a default layout that contains ""{{ site.pages | sort:'value' | map:'title' | join:', ' }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,8,"I should see exactly ""Page-2, Page-1"" in ""_site/page-1.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Sort by an arbitrary variable,9,"I should see exactly ""Page-2, Page-1"" in ""_site/page-2.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,2,I have the following pages,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,3,I have the following page,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,4,"I have a default layout that contains ""{% assign sorted_pages = site.pages | sort: 'title' %}The rule of {{ sorted_pages.size }}: {% for p in sorted_pages %}{{ p.content | strip_html | strip_newlines }}, {% endfor %}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title,8,"I should see exactly ""The rule of 3: Jump, Fly, Run,"" in ""_site/bird.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,2,I have the following pages,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,3,I have the following page,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,4,"I have a default layout that contains ""{% assign sorted_pages = site.pages | sort: 'title', 'last' %}The rule of {{ sorted_pages.size }}: {% for p in sorted_pages %}{{ p.content | strip_html | strip_newlines }}, {% endfor %}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Sort pages by the title ordering pages without title last,8,"I should see exactly ""The rule of 3: Fly, Run, Jump,"" in ""_site/bird.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,3,"I have a ""string-value.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,4,"I have a ""string-value-array.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,5,"I have a ""string-value-hash.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,6,"I have a ""nil-value.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,7,"I have an ""empty-liquid-literal.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,8,"I have a ""blank-liquid-literal.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,9,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,10,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,11,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,12,"I should see exactly ""<p>Elephant</p>"" in ""_site/string-value.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,13,"I should see exactly ""<p>Bird, Cat</p>"" in ""_site/string-value-array.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,14,"I should see exactly ""<p>Bird</p>"" in ""_site/string-value-hash.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,15,"I should see exactly ""<p>Dog</p>"" in ""_site/nil-value.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,16,"I should see exactly ""<p>Dog, Goat, Horse, Iguana</p>"" in ""_site/empty-liquid-literal.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
embed_filters.feature,Filter posts by given property and value,17,"I should see exactly ""<p>Dog, Goat, Horse, Iguana</p>"" in ""_site/blank-liquid-literal.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,2,"I have a pretty layout that contains ""THIS IS THE LAYOUT: {{content}}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,5,"I have an ""index.html"" page with title ""some title"" that contains ""just some page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,6,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """"}, values: {layout: ""pretty""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,10,"I should see ""THIS IS THE LAYOUT: <p>just some post</p>"" in ""_site/2013/09/11/default-layout.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables internally,11,"I should see ""THIS IS THE LAYOUT: just some page"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,3,"I have an ""index.html"" page that contains ""just {{page.custom}} by {{page.author}}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,4,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """"}, values: {custom: ""some special data"", author: ""Ben""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,8,"I should see ""<p>some special data</p>\n<div>Ben</div>"" in ""_site/2013/09/11/default-data.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use default for frontmatter variables in Liquid,9,"I should see ""just some special data by Ben"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,2,"I have a root layout that contains ""root: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,3,"I have a subfolder layout that contains ""subfolder: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,4,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,5,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,6,I have a special/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,7,"I have the following post in ""special""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,8,"I have an ""index.html"" page with title ""overview"" that contains ""Overview for {{page.description}}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,9,"I have an ""special/index.html"" page with title ""section overview"" that contains ""Overview for {{page.description}}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,10,"I have a configuration file with ""defaults"" set to ""[{scope: {path: ""special""}, values: {layout: ""subfolder"", description: ""the special section""}}, {scope: {path: """"}, values: {layout: ""root"", description: ""the webpage""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,11,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,12,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,13,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,14,"I should see ""root: <p>info on the webpage</p>"" in ""_site/2013/10/14/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,15,"I should see ""subfolder: <p>info on the special section</p>"" in ""_site/special/2013/10/14/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,16,"I should see ""root: Overview for the webpage"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by path,17,"I should see ""subfolder: Overview for the special section"" in ""_site/special/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,2,"I have a main layout that contains ""main: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,5,I have a special/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,6,"I have the following post in ""special""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,7,"I have a configuration file with ""defaults"" set to ""[{scope: {path: ""special""}, values: {layout: ""main""}}, {scope: {path: ""special/_posts""}, values: {layout: ""main""}}, {scope: {path: ""_posts""}, values: {layout: ""main""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,11,"I should see ""main: <p>content of site/2013/10/14/about.html</p>"" in ""_site/2013/10/14/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,12,"I should see ""main: <p>content of site/special/2013/10/14/about1.html</p>"" in ""_site/special/2013/10/14/about1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter variables by relative path,13,"I should see ""main: <p>content of site/special/2013/10/14/about2.html</p>"" in ""_site/special/2013/10/14/about2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,2,"I have a main layout that contains ""main: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,3,I have a _posts/en directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,4,"I have the following post under ""en""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,5,I have a _posts/de directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,6,"I have the following post under ""de""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,7,"I have a configuration file with ""defaults"" set to ""[{scope: {path: ""_posts/en""}, values: {layout: ""main"", lang: ""en""}}, {scope: {path: ""_posts/de""}, values: {layout: ""main"", lang: ""de""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,10,"I should see ""main: <p>en is the current language</p>"" in ""_site/2014/09/01/helloworld.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter scopes for subdirectories,11,"I should see ""main: <p>de is the current language</p>"" in ""_site/2014/09/01/hallowelt.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,3,"I have an ""index.html"" page that contains ""interesting stuff""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,4,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """", type: ""post""}, values: {permalink: ""/post.html""}}, {scope: {path: """", type: ""page""}, values: {permalink: ""/page.html""}}, {scope: {path: """"}, values: {permalink: ""/perma.html""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,6,"I should see ""blabla"" in ""_site/post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,7,"I should see ""interesting stuff"" in ""_site/page.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults by type,8,"the ""_site/perma.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,3,"I have an ""index.html"" page with permalink ""override.html"" that contains ""nothing""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,4,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """"}, values: {permalink: ""/perma.html"", author: ""Chris""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,6,"I should see ""a blog by some guy"" in ""_site/frontmatter.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,7,"I should see ""nothing"" in ""_site/override.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Actual frontmatter overrides defaults,8,"the ""_site/perma.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Define permalink default for posts,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Define permalink default for posts,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Define permalink default for posts,3,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """", type: ""posts""}, values: {permalink: ""/:categories/:title/""}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Define permalink default for posts,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Define permalink default for posts,5,"I should see ""blabla"" in ""_site/blog/testpost/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,1,I have a _slides directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,2,"I have a ""index.html"" file that contains ""nothing""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,3,"I have a ""_slides/slide1.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,4,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Use frontmatter defaults in collections,8,"I should see ""Value: Test"" in ""_site/slides/slide1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,1,I have a _slides directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,2,"I have a ""index.html"" file that contains ""nothing""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,3,"I have a ""_slides/slide2.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,4,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Override frontmatter defaults inside a collection,8,"I should see ""Value: Override"" in ""_site/slides/slide2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Deep merge frontmatter defaults,1,"I have an ""index.html"" page with fruit ""{orange: 1}"" that contains ""Fruits: {{ page.fruit.orange | plus: page.fruit.apple }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Deep merge frontmatter defaults,2,"I have a configuration file with ""defaults"" set to ""[{scope: {path: """"}, values: {fruit: {apple: 2}}}]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Deep merge frontmatter defaults,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
frontmatter_defaults.feature,Deep merge frontmatter defaults,4,"I should see ""Fruits: 3"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
highlighting.feature,highlighting an apache configuration,1,"I have an ""index.html"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
highlighting.feature,highlighting an apache configuration,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
highlighting.feature,highlighting an apache configuration,3,I should get a zero exit-status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
highlighting.feature,highlighting an apache configuration,4,"I should see ""<span class=""nc"">RewriteCond</span>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,1,"I have an ""index.html"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,3,I should get a zero exit-status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,4,"I should see ""<span class=\""hll\""><span class=\""k\"">module</span> <span class=\""nn\"">Jekyll</span>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,5,"I should see ""<span class=\""hll\"">  <span class=\""k\"">module</span> <span class=\""nn\"">Tags</span>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking lines 1 and 2 in a Ruby code block with valid syntax,6,"I should see ""<span class=\""k\"">class</span> <span class=\""nc\"">HighlightBlock</span"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking a single line in a Ruby code block with invalid syntax,1,"I have an ""index.html"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
highlighting.feature,marking a single line in a Ruby code block with invalid syntax,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
highlighting.feature,marking a single line in a Ruby code block with invalid syntax,3,"I should see ""Liquid Exception: Syntax Error"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Run some code after site reset,6,"I should see ""mytinypage"" in ""_site/foo.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,2,"I have a ""index.html"" page that contains ""{{ site.injected }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,3,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the payload before rendering the site,7,"I should see ""myparam!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,2,"I have a ""page1.html"" page that contains ""page1""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,3,"I have a ""page2.html"" page that contains ""page2""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,4,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,8,"the ""_site/page1.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the site contents after reading,9,"I should see ""page2"" in ""_site/page2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,3,"I have a ""page1.html"" page that contains ""page1""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with the site files after they've been written to disk,7,"I should see ""page1"" in ""_site/firstpage.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,3,"I have a ""page1.html"" page that contains ""page1""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a page right after it is initialized,7,"I should see ""page1"" in ""_site/renamed.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,3,"I have a ""page1.html"" page that contains ""{{ page.myparam }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,4,"I have a ""page2.html"" page that contains ""{{ page.myparam }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,6,"I should see ""special"" in ""_site/page1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for one page but not another,7,"I should not see ""special"" in ""_site/page2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,2,"I have a ""_layouts/page.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,3,"I have a ""page.md"" page with layout ""page"" that contains ""### Heading""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,4,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,5,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,9,"I should see ""<h3>Page heading</h3>"" in ""_site/page.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a page before rendering layout,10,"I should see ""<h4 id=\""heading\"">Heading</h4>"" in ""_site/page.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify page contents before writing to disk,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify page contents before writing to disk,2,"I have a ""index.html"" page that contains ""WRAP ME""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Modify page contents before writing to disk,3,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify page contents before writing to disk,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify page contents before writing to disk,5,"I should see ""{{{{{ WRAP ME }}}}}"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a page after writing it to disk,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a page after writing it to disk,2,"I have a ""index.html"" page that contains ""HELLO FROM A PAGE""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Work with a page after writing it to disk,3,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Work with a page after writing it to disk,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a page after writing it to disk,5,"I should see ""HELLO FROM A PAGE"" in ""_site/index.html.moved""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,4,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a post right after it is initialized,8,"I should see ""pbagrag sbe ragel1."" in ""_site/2015/03/14/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,4,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,6,"I should see ""old post"" in ""_site/2015/03/14/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter the payload for certain posts,7,"I should see ""new post"" in ""_site/2015/03/15/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,2,"I have a ""_layouts/post.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,4,"I have a ""_posts/2016-01-01-example.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,5,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,6,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,10,"I should see ""<h3>Page heading</h3>"" in ""_site/2016/01/01/example.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a post before rendering layout,11,"I should see ""<h4 id=\""heading\"">Heading</h4>"" in ""_site/2016/01/01/example.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,4,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,6,"I should see ""the answer to life, the universe and everything"" in ""_site/2015/03/14/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify post contents before writing to disk,7,"I should see ""48"" in ""_site/2015/03/15/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,4,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,6,"I should see ""_site/2015/03/14/entry1.html at"" in ""_site/post-build.log""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Work with a post after writing it to disk,7,"I should see ""_site/2015/03/15/entry2.html at"" in ""_site/post-build.log""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,3,"I have a ""index.html"" page that contains ""WRAP ME""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,4,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,7,"I should see ""{{{{{ WRAP ME }}}}}"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Register a hook on multiple owners at the same time,8,"I should see ""{{{{{ <p>entry one</p> }}}}}"" in ""_site/2015/03/14/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Allow hooks to have a named priority,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Allow hooks to have a named priority,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Allow hooks to have a named priority,3,"I have a ""index.html"" page that contains ""WRAP ME""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Allow hooks to have a named priority,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Allow hooks to have a named priority,5,"I should see ""4 3 1 2 WRAP ME"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,3,"I have a ""_config.yml"" file that contains ""collections: [ memes ]""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,4,I have a _memes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,5,"I have a ""_memes/doc1.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,6,"I have an ""index.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Alter a document right after it is initialized,10,"I should see ""all your base are belong to us"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,2,"I have a ""_layouts/meme.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,4,I have a _memes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,5,"I have a ""_memes/doc1.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,6,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,7,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,11,"I should see ""<h3>Page heading</h3>"" in ""_site/memes/doc1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of a document before rendering layout,12,"I should see ""<h4 id=\""all-your-base\"">all your base</h4>"" in ""_site/memes/doc1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,2,"I have a ""_layouts/meme.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,4,I have a _memes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,5,"I have a ""_memes/doc1.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,7,"I have a ""_posts/2016-01-01-example.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,8,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,9,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,10,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,13,"I should see ""<h3>Page heading</h3>"" in ""_site/memes/doc1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,14,"I should see ""<h4 id=\""all-your-base\"">all your base</h4>"" in ""_site/memes/doc1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Modify the converted HTML content of document of a particular collection before rendering layout,15,"I should see ""<h3 id=\""all-your-base\"">all your base</h3>"" in ""_site/2016/01/01/example.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",4,I have a _memes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",5,"I have a ""_memes/doc1.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,"Update a document after rendering it, but before writing it to disk",9,"I should see ""<p class=\""meme\"">all your base are belong to us"" in ""_site/memes/doc1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,4,I have a _memes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,5,"I have a ""_memes/doc1.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Perform an action after every document is written,9,"I should see ""Wrote document 0"" in ""_site/document-build.log""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,1,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,2,"I have a ""_plugins/ext.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,4,"I have a ""_layouts/custom.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,5,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,6,"I have a ""_includes/foo.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,7,"I have an ""index.html"" page with layout ""custom"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,9,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
hooks.feature,Set a custom payload['page'] property,10,"I should see ""page content\n hello world"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,2,I have a _posts/snippets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,4,"I have an ""_posts/snippets/welcome_para.md"" file that contains ""Welcome back Dear Reader!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a file relative to a post,8,"I should see ""Welcome back Dear Reader!"" in ""_site/2018/09/02/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,2,I have a _posts/snippets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,3,I have a _posts/snippets/welcome_para directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,5,"I have an ""_posts/snippets/welcome_para.md"" file that contains ""{% include_relative snippets/welcome_para/greeting.md %} Dear Reader!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,6,"I have an ""_posts/snippets/welcome_para/greeting.md"" file that contains ""Welcome back""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post,10,"I should see ""Welcome back Dear Reader!"" in ""_site/2018/09/02/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,2,I have a _posts/snippets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,3,I have a _posts/snippets/welcome_para directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,4,"I have a ""_posts/2018-09-02-star-wars.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,5,"I have an ""_posts/snippets/welcome_para.md"" file that contains ""{% include_relative snippets/welcome_para/greeting.md %} Dear Reader!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,6,"I have an ""_posts/snippets/welcome_para/greeting.md"" file that contains ""Welcome back""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,7,"I have an ""index.md"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,11,"I should see ""Welcome back Dear Reader!"" in ""_site/2018/09/02/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a post as an excerpt,12,"I should see ""Welcome back Dear Reader!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,1,I have a snippets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,2,I have a snippets/welcome_para directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,3,"I have a ""index.md"" page that contains ""{% include_relative snippets/welcome_para.md %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,4,"I have a ""snippets/welcome_para.md"" file that contains ""{% include_relative snippets/welcome_para/greeting.md %} Dear Reader!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,5,"I have a ""snippets/welcome_para/greeting.md"" file that contains ""Welcome back""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_relative_tag.feature,Include a nested file relative to a page at root,9,"I should see ""Welcome back Dear Reader!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,2,"I have an ""_includes/header.html"" file that contains ""<header>My awesome blog header: {{include.param}}</header>""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,3,"I have an ""_includes/params.html"" file that contains ""Parameters:<ul>{% for param in include %}<li>{{param[0]}} = {{param[1]}}</li>{% endfor %}</ul>""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,4,"I have an ""_includes/ignore.html"" file that contains ""<footer>My blog footer</footer>""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,5,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,6,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,10,"I should see ""<header>My awesome blog header: myparam</header>"" in ""_site/2013/03/21/include-files.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,11,"I should not see ""myparam"" in ""_site/2013/03/21/ignore-params-if-unused.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,12,"I should see ""<li>date = today</li>"" in ""_site/2013/03/21/list-multiple-parameters.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,13,"I should see ""<li>start = tomorrow</li>"" in ""_site/2013/03/21/list-multiple-parameters.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,14,"I should not see ""<header>My awesome blog header: myparam</header>"" in ""_site/2013/03/21/dont-keep-parameters.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,15,"I should see ""<header>My awesome blog header: </header>"" in ""_site/2013/03/21/dont-keep-parameters.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,16,"I should see ""<li>cool = param with spaces</li>"" in ""_site/2013/04/07/allow-params-with-spaces-and-quotes.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,17,"I should see ""<li>super = \""quoted\""</li>"" in ""_site/2013/04/07/allow-params-with-spaces-and-quotes.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,18,"I should see ""<li>single = has \""quotes\""</li>"" in ""_site/2013/04/07/allow-params-with-spaces-and-quotes.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,19,"I should see ""<li>escaped = 'single' quotes</li>"" in ""_site/2013/04/07/allow-params-with-spaces-and-quotes.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,20,"I should see ""<li>param1_or_2 = value</li>"" in ""_site/2013/04/12/parameter-syntax.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,21,"I should see ""<li>local = some text</li>"" in ""_site/2013/06/22/pass-a-variable.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with parameters,22,"I should see ""<li>title = Pass a variable</li>"" in ""_site/2013/06/22/pass-a-variable.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,2,"I have an ""_includes/snippet.html"" file that contains ""a snippet""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,3,"I have an ""_includes/parametrized.html"" file that contains ""works with {{include.what}}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,4,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,5,"I have an ""index.html"" page that contains ""{% include {{site.include_file1}} %} that {% include {{site.include_file2}} what='parameters' %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file from a variable,9,"I should see ""a snippet that works with parameters"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,2,"I have an ""_includes/one.html"" file that contains ""one""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,3,"I have an ""_includes/two.html"" file that contains ""two""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,4,"I have an ""index.html"" page with files ""[one.html, two.html]"" that contains ""{% for file in page.files %}{% include {{file}} %} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a variable file in a loop,8,"I should see ""one two"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,2,"I have an ""_includes/one.html"" file that contains ""one included""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,3,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,4,"I have an ""index.html"" page that contains ""{% include {{ site.include_file | append: '.html' }} %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with variables and filters,8,"I should see ""one included"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,2,"I have an ""_includes/one.html"" file that contains ""one included""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,3,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,4,"I have an ""index.html"" page that contains ""{% include {{ site.include_file }}.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with partial variables,8,"I should see ""one included"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,2,"I have an ""_includes/one.html"" file that contains ""include""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,3,"I have an ""index.html"" page that contains ""{% include one.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,7,"I should see ""include"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,8,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,9,"I have an ""_includes/one.html"" file that contains ""include content changed""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,10,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file and rebuild when include content is changed,11,"I should see ""include content changed"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,2,"I have an ""_includes/header-en.html"" file that contains ""include""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,3,"I have an ""index.html"" page that contains ""{% assign name = 'header' %}{% assign locale = 'en' %}{% include {{name}}-{{locale}}.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file with multiple variables,7,"I should see ""include"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,1,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,2,"I have an ""_includes/header-en.html"" file that contains ""include""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,3,"I have an ""index.html"" page that contains ""{% include ./header-en.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,5,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,6,"I should see ""Invalid syntax for include tag."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,7,"I have an ""index.html"" page that contains ""{% include foo/.header-en.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,9,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,10,"I should see ""Invalid syntax for include tag."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,11,"I have an ""index.html"" page that contains ""{% include //header-en.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,12,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,13,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,14,"I should see ""Invalid syntax for include tag."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,15,"I have an ""index.html"" page that contains ""{% include ..header-en.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,16,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,17,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,18,"I should see ""Invalid syntax for include tag."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,19,"I have an ""index.html"" page that contains ""{% include header-en.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,20,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,21,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,22,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
include_tag.feature,Include a file-path with non-alphanumeric character sequences,23,"I should see ""include"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,4,"I have a default layout that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,5,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,8,"I should see ""Post Layout: <p>The only winning move is not to play.</p>"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,9,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,10,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,11,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Produce correct output site,12,"I should see ""Post Layout: <p>The only winning move is not to play.</p>"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Generate a metadata file,1,"I have an ""index.html"" file that contains ""Basic Site""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Generate a metadata file,2,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Generate a metadata file,3,"the "".jekyll-metadata"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,1,"I have an ""index.html"" file that contains ""Basic Site""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,2,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,5,"I should see ""Basic Site"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,6,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,7,"I have an ""index.html"" file that contains ""Bacon Site""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,8,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when content is changed,11,"I should see ""Bacon Site"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,2,"I have an ""index.html"" page with layout ""default"" that contains ""Basic Site with Layout""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,3,"I have a default layout that contains ""Page Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,4,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,7,"I should see ""Page Layout: Basic Site with Layout"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,8,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,9,"I have a default layout that contains ""Page Layout Changed: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,10,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when layout is changed,13,"I should see ""Page Layout Changed: Basic Site with Layout"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,2,"I have an ""index.html"" page that contains ""Basic Site with include tag: {% include about.textile %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,3,"I have an ""_includes/about.textile"" file that contains ""Generated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,4,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,7,"I should see ""Basic Site with include tag: Generated by Jekyll"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,8,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,9,"I have an ""_includes/about.textile"" file that contains ""Regenerated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,10,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when an include is changed,13,"I should see ""Basic Site with include tag: Regenerated by Jekyll"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,2,"I have a configuration file with ""collections_dir"" set to ""collections""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,3,I have a collections/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,4,"I have the following post within the ""collections"" directory","Given(%r!^I have the following (draft|post)s? within the ""(.*)"" directory:$!) do |type, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])

    filename = type == ""draft"" ? ""#{title}.markdown"" : ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.markdown""

    path = File.join(folder, ""_#{type}s"", filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,5,"I have an ""_includes/about.html"" file that contains ""Generated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,6,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,9,"I should see ""Basic Site with include tag: Generated by Jekyll"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,10,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,11,"I have an ""_includes/about.html"" file that contains ""Regenerated by Jekyll""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,12,I run jekyll build -I,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,13,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,14,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,Rebuild when a dependency of document in custom collection_dir is changed,15,"I should see ""Basic Site with include tag: Regenerated by Jekyll"" in ""_site/2009/03/27/wargames.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,2,"I have an ""index.md"" page that contains ""Themed site""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,3,I run jekyll build --incremental --verbose,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,6,"I should see ""Rendering: index.md"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,7,"I should see ""Themed site"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,8,I wait 1 second,"Given(%r!^I wait (\d+) second(s?)$!) do |time, _|
  sleep(time.to_f)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,9,"I have an ""about.md"" page that contains ""About Themed site""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,10,I run jekyll build --incremental --verbose,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,11,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,12,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,13,"I should not see ""Rendering: index.md"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,14,"I should see ""Themed site"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
incremental_rebuild.feature,A themed-site and incremental regeneration,15,"I should see ""About Themed site"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,2,"I have a ""_layouts/999.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,3,"I have an ""index.html"" page with layout ""custom"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,4,"I have an ""index.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,6,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,7,"I should see ""page content layout content"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,2,"I have a ""_layouts/custom.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,3,"I have an ""index.html"" page with layout ""custom"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,5,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
layout_data.feature,Use custom layout data,6,"I should see ""page content\n foo: my custom data"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,2,"I have a ""_layouts/custom.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,3,"I have a ""_layouts/base.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,4,"I have an ""index.html"" page with layout ""custom"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,6,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data,7,"I should see ""page content\n foo: my custom data"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,2,"I have a ""_layouts/default.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,3,"I have a ""_layouts/special.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,4,"I have a ""_layouts/page.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,5,"I have an ""index.html"" page with layout ""special"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,6,"I have an ""jekyll.html"" page with layout ""page"" that contains ""page content""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,8,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,9,"I should see ""page content\n foo: 'my special data' bar: 'im special'"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
layout_data.feature,Inherit custom layout data and clear when not present,10,"I should see ""page content\n foo: '' bar: 'im page'"" in ""_site/jekyll.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,2,"I have an ""about.md"" page that contains ""[Home]({% link index.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,6,"I should see ""<p><a href=\""/about.html\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages,7,"I should see ""<p><a href=\""/\"">Home</a></p>"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,2,"I have an ""about.md"" page with permalink ""/about/"" that contains ""[Home]({% link index.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,6,"I should see ""<p><a href=\""/about/\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom page-permalinks,7,"I should see ""<p><a href=\""/\"">Home</a></p>"" in ""_site/about/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,2,"I have an ""about.md"" page that contains ""[Home]({% link index.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,3,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,7,"I should see ""<p><a href=\""/about/\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with custom site-wide-permalinks,8,"I should see ""<p><a href=\""/\"">Home</a></p>"" in ""_site/about/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,2,"I have an ""about.md"" page that contains ""[Home]({% link index.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,3,"I have a configuration file with ""baseurl"" set to ""/blog""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,7,"I should see ""<p><a href=\""/blog/about.html\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl,8,"I should see ""<p><a href=\""/blog/\"">Home</a></p>"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,2,"I have an ""about.md"" page that contains ""[Home]({% link index.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,3,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,7,"I should see ""<p><a href=\""/blog/about/\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Basic site with two pages and custom baseurl and permalinks,8,"I should see ""<p><a href=\""/blog/\"">Home</a></p>"" in ""_site/about/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,2,"I have an ""about.md"" page that contains ""[Contact]({% link contact.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,4,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,5,the _site directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Linking to a ghost file,6,"I should see ""Could not find document 'contact.md' in tag 'link'"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,1,"I have an ""index.md"" page that contains ""[About my projects]({% link about.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,2,"I have an ""about.md"" page that contains ""[Latest Hack]({% link _posts/2018-02-15-metaprogramming.md %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,4,"I have an ""_posts/2018-02-15-metaprogramming.md"" page that contains ""[Download This]({% link script.txt %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,5,"I have a ""script.txt"" file that contains ""Static Alert!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,9,"I should see ""<p><a href=\""/about.html\"">About my projects</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,10,"I should see ""<p><a href=\""/2018/02/15/metaprogramming.html\"">Latest Hack</a></p>"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,11,"I should see ""<p><a href=\""/script.txt\"">Download This</a></p>"" in ""_site/2018/02/15/metaprogramming.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
link_tag.feature,Complex site with a variety of files,12,"I should see ""Static Alert!"" in ""_site/script.txt""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,1,"I have a configuration file with ""paginate"" set to ""5""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,2,"I have an ""index.html"" page that contains ""Index - {% for post in site.posts %} {{ post.content }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,8,"I should see ""Index"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,9,"I should see ""<h1 id=\""my-title\"">My Title</h1>"" in ""_site/2009/03/27/hackers.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in list on index,10,"I should see ""<h1 id=\""my-title\"">My Title</h1>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,2,"I have an ""index.html"" page that contains ""Index - {% for post in paginator.posts %} {{ post.content }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,4,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,8,"I should see ""Index"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
markdown.feature,Markdown in pagination on index,9,"I should see ""<h1 id=\""my-title\"">My Title</h1>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,3,"I have an ""index.html"" page that contains ""{{ paginator.posts.size }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,4,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,7,the _site/page<exist> directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,8,"the ""_site/page<exist>/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,9,"I should see ""<posts>"" in ""_site/page<exist>/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
pagination.feature,Paginate with N posts per page,10,"the ""_site/page<not_exist>/index.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,2,I have a blog directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,3,"I have an ""blog/index.html"" page that contains ""{{ paginator.posts.size }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,4,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,7,the _site/blog/page-<exist> directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,8,"the ""_site/blog/page-<exist>/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,9,"I should see ""<posts>"" in ""_site/blog/page-<exist>/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path,10,"the ""_site/blog/page-<not_exist>/index.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,2,I have a blog directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,3,"I have an ""blog/index.html"" page that contains ""{{ paginator.posts.size }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,4,"I have an ""index.html"" page that contains ""Don't pick me!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,5,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,6,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,8,the _site/blog/page/<exist> directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,9,"the ""_site/blog/page/<exist>/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,10,"I should see ""<posts>"" in ""_site/blog/page/<exist>/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
pagination.feature,Setting a custom pagination path without an index.html in it,11,"the ""_site/blog/page/<not_exist>/index.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,3,"I have a configuration file with ""permalink"" set to ""none""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use none permalink schema,7,"I should see ""Totally nothing."" in ""_site/none-permalink-schema.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,3,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema,7,"I should see ""Totally wordpress."" in ""_site/2009/03/27/pretty-permalink-schema/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,1,"I have an ""index.html"" page that contains ""Totally index""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,2,"I have an ""awesome.html"" page that contains ""Totally awesome""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,3,"I have an ""sitemap.xml"" page that contains ""Totally uhm, sitemap""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,4,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,8,"I should see ""Totally index"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,9,"I should see ""Totally awesome"" in ""_site/awesome/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema for pages,10,"I should see ""Totally uhm, sitemap"" in ""_site/sitemap.xml""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,3,"I have a configuration file with ""permalink"" set to ""/blog/:year/:month/:day/:title/""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with prefix,7,"I should see ""Totally custom."" in ""_site/blog/2009/03/27/custom-permalink-schema/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,3,"I have a configuration file with ""permalink"" set to ""/:categories/:title.html""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with category,7,"I should see ""Totally custom."" in ""_site/stuff/custom-permalink-schema.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,3,"I have a configuration file with ""permalink"" set to ""/:month-:day-:year/:title.html""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with squished date,7,"I should see ""Totally custom."" in ""_site/03-27-2009/custom-permalink-schema.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with date and time,7,"I should see ""Totally custom."" in ""_site/20090327223107.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,6,the _site/custom/posts/1 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post permalink,7,"I should see ""bla bla"" in ""_site/custom/posts/1/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,6,the _site/custom/posts directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use per-post ending in .html,7,"I should see ""bla bla"" in ""_site/custom/posts/some.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,2,"I have an ""_posts/2009-03-27-Pretty-Permalink-Schema.md"" page that contains ""Totally wordpress""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,3,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with cased file name,7,"I should see ""Totally wordpress."" in ""_site/2009/03/27/Pretty-Permalink-Schema/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,2,"I have an ""_posts/2009-03-27-Custom-Schema.md"" page with title ""Custom Schema"" that contains ""Totally awesome""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,3,"I have a configuration file with ""permalink"" set to ""/:year/:month/:day/:slug/""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use custom permalink schema with cased file name,7,"I should see ""Totally awesome"" in ""_site/2009/03/27/custom-schema/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,2,"I have an ""_posts/2009-03-27-Custom_Schema.md"" page with title ""Custom Schema"" that contains ""Totally awesome""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,3,"I have a configuration file with ""permalink"" set to ""pretty""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use pretty permalink schema with title containing underscore,7,"I should see ""Totally awesome"" in ""_site/2009/03/27/Custom_Schema/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,2,"I have an ""_posts/2016-01-18-i-am-php.md"" page with permalink ""/2016/i-am-php.php"" that contains ""I am PHP""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,3,"I have a ""i-am-also-php.md"" page with permalink ""/i-am-also-php.php"" that contains ""I am also PHP""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,7,"I should see ""I am PHP"" in ""_site/2016/i-am-php.php""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Use a non-HTML file extension in the permalink,8,"I should see ""I am also PHP"" in ""_site/i-am-also-php.php""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,1,"I have a ""cool.md"" page with permalink ""/amazing.html"" that contains ""I am cool""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,2,"I have an ""awesome.md"" page with permalink ""/amazing.html"" that contains ""I am also awesome""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,3,"I have an ""amazing.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,4,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,5,I have a _puppies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,6,I have the following documents under the puppies collection,"Given(%r!^I have the following documents? under the (.*) collection:$!) do |folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    filename = ""#{title}.md""
    dest_folder = ""_#{folder}""

    path = File.join(dest_folder, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,7,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,8,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,9,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,10,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,11,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,12,"I should see ""Conflict: The following destination is shared by multiple files."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,13,"I should see ""_site/amazing.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,14,"I should see ""awesome.md"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,15,"I should see ""cool.md"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,16,"I should see ""amazing.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,17,"I should see ""_site/puppies/2009/03/27/rover.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,18,"I should see ""_posts/2009-03-27-rover.markdown"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Using the same permalink twice,19,"I should see ""_puppies/rover.md"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,1,"I have a configuration file with ""plugins"" set to ""[jekyll-redirect-from]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,2,"I have a ""deals.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,3,"I have a ""offers.html"" page with permalink ""/offers/"" that contains ""Hurry! Limited time only!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,7,"I should not see ""Conflict: The following destination is shared by multiple files."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,8,"I should not see ""_site/offers/index.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,9,"I should not see ""offers.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
permalinks.feature,Redirecting from an existing permalink,10,"I should not see ""redirect.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,1,"I have an ""index.html"" file that contains ""Whatever""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,2,"I have a configuration file with ""plugins"" set to ""[jekyll_test_plugin]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,6,"I should see ""Whatever"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a gem-based plugin,7,"I should see ""this is a test"" in ""_site/test.txt""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,1,"I have an ""index.html"" file that contains ""Whatever""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,2,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,3,I run jekyll build --safe,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,6,"I should see ""Whatever"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
plugins.feature,Add an empty whitelist to restrict all gems,7,"the ""_site/test.txt"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,1,"I have an ""index.html"" file that contains ""Whatever""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,2,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,3,I run jekyll build --safe,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,6,"I should see ""Whatever"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,7,"the ""_site/test.txt"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
plugins.feature,Add a whitelist to restrict some gems but allow others,8,"I should see ""this is a test"" in ""_site/test.txt""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,4,"I have a simple layout that contains ""Post title: {{ page.title }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.title variable,8,"I should see ""Post title: Star Wars"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,4,"I have a simple layout that contains ""Post url: {{ page.url }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.url variable,8,"I should see ""Post url: /2009/03/27/star-wars.html"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,4,"I have a simple layout that contains ""Page name: {{ page.name }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.name variable,8,"I should see ""Page name: 2009-03-27-star-wars.markdown"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,4,"I have a simple layout that contains ""Post date: {{ page.date | date_to_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable,8,"I should see ""Post date: 27 Mar 2009"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable with invalid,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable with invalid,2,"I have a ""_posts/2016-01-01-test.md"" page with date ""tuesday"" that contains ""I have a bad date.""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable with invalid,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable with invalid,4,the _site directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.date variable with invalid,5,"I should see ""Document '_posts/2016-01-01-test.md' does not have a valid date in the YAML front matter."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_data.feature,Invalid date in filename,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Invalid date in filename,2,"I have a ""_posts/2016-22-01-test.md"" page that contains ""I have a bad date.""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_data.feature,Invalid date in filename,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Invalid date in filename,4,the _site directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Invalid date in filename,5,"I should see ""Document '_posts/2016-22-01-test.md' does not have a valid date in the filename."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,4,"I have a simple layout that contains ""Post id: {{ page.id }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.id variable,8,"I should see ""Post id: /2009/03/27/star-wars"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,4,"I have a simple layout that contains ""Post content: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.content variable,8,"I should see ""Post content: <p>Luke, I am your father.</p>"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,1,I have a movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,2,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,5,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder,9,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,1,I have a movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,2,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,5,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has category in YAML,9,"I should see ""Post category: movies"" in ""_site/movies/film/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,1,I have a movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,2,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,5,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and has categories in YAML,9,"I should see ""Post category: movies"" in ""_site/movies/film/scifi/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,1,I have a movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,2,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,5,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in a folder and duplicated category is in YAML,9,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,1,I have a Sci-Fi Movi3s directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,2,I have a Sci-Fi Movi3s/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,4,"I have the following post in ""Sci-Fi Movi3s""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,5,"I have a ""_layouts/simple.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,9,"I should see ""Post categories: Sci-Fi Movi3s, vintage"" in ""_site/sci-fi movi3s/vintage/2020/04/03/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories when category is a composite of multiple words,10,"I should see ""Post URL: /sci-fi%20movi3s/vintage/2020/04/03/star-wars.html"" in ""_site/sci-fi movi3s/vintage/2020/04/03/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,1,I have a Sci-Fi Movi3s directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,2,I have a Sci-Fi Movi3s/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,4,"I have the following post in ""Sci-Fi Movi3s""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,5,"I have a ""_layouts/simple.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,6,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,10,"I should see ""Post categories: Sci-Fi Movi3s, vintage"" in ""_site/sci-fi-movi3s/vintage/2020/04/03/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.slugified_categories to generate URL when category is a composite of multiple words,11,"I should see ""Post URL: /sci-fi-movi3s/vintage/2020/04/03/star-wars.html"" in ""_site/sci-fi-movi3s/vintage/2020/04/03/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,4,"I have a simple layout that contains ""Post tags: {{ page.tags }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.tags variable,8,"I should see ""Post tags: twist"" in ""_site/2009/05/18/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,1,I have a scifi directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,2,I have a scifi/movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,3,I have a scifi/movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,4,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,5,"I have the following post in ""scifi/movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,6,"I have a simple layout that contains ""Post categories: {{ page.categories | array_to_sentence_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders,10,"I should see ""Post categories: scifi and movies"" in ""_site/scifi/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,1,I have a scifi directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,2,I have a scifi/Movies directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,3,I have a scifi/Movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,4,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,5,"I have the following post in ""scifi/Movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,6,"I have a simple layout that contains ""Post categories: {{ page.categories | array_to_sentence_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in folders with mixed case,10,"I should see ""Post categories: scifi and Movies"" in ""_site/scifi/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,4,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML,8,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,4,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when category is in YAML and is mixed-case,8,"I should see ""Post category: Movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,4,"I have a simple layout that contains ""Post categories: {{ page.categories | array_to_sentence_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML,8,"I should see ""Post categories: scifi and movies"" in ""_site/scifi/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,4,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML and are duplicated,8,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,1,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,2,"I have a ""movies/_posts/2009-03-27-star-wars.html"" page with layout ""simple"" that contains ""hi""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,4,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Superdirectories of _posts applied to post.categories,8,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,1,I have a movies/_posts/scifi directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,2,"I have a ""movies/_posts/scifi/2009-03-27-star-wars.html"" page with layout ""simple"" that contains ""hi""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,4,"I have a simple layout that contains ""Post category: {{ page.categories }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Subdirectories of _posts not applied to post.categories,8,"I should see ""Post category: movies"" in ""_site/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,4,"I have a simple layout that contains ""Post categories: {{ page.categories | array_to_sentence_string }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,8,"I should see ""Post categories: scifi and Movies"" in ""_site/scifi/movies/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use post.categories variable when categories are in YAML with mixed case,9,"I should see ""Post categories: SciFi and movies"" in ""_site/scifi/movies/2013/03/17/star-trek.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,6,"I should not see ""Hello Unrendered Post"" in ""_site/2017/07/06/unrendered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,7,"I should see ""Hello {{ page.title }}"" in ""_site/2017/07/06/unrendered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.render_with_liquid variable,8,"I should see ""Hello Rendered Post"" in ""_site/2017/07/06/rendered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,1,I have a <dir>/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,2,"I have the following post in ""<dir>""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use page.path variable,6,"I should see ""Source path: <path_prefix>_posts/2013-04-12-my-post.html"" in ""_site/<dir>/2013/04/12/my-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Cannot override page.path variable,6,"I should see ""Non-custom path: _posts/2013-04-12-override.markdown"" in ""_site/2013/04/12/override.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,2,"I have an ""index.html"" file that contains ""Published!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,7,"the ""_site/2009/03/27/star-wars.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Disable a post from being published,8,"I should see ""Published!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,4,"I have a simple layout that contains ""Post author: {{ page.author }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a custom variable,8,"I should see ""Post author: Darth Vader"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,4,"I have a simple layout that contains ""{{page.title}} has class {{page.class}}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Use a variable which is a reserved keyword in Ruby,8,"I should see ""My post has class kewl-post"" in ""_site/2016/01/21/my-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,2,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,4,"I have a ordered layout that contains ""Previous post: {{ page.previous.title }} and next post: {{ page.next.title }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,8,"I should see ""next post: Some like it hot"" in ""_site/2009/03/27/star-wars.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Previous and next posts title,9,"I should see ""Previous post: Some like it hot"" in ""_site/2009/05/27/terminator.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,2,I have a _plugins directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,4,"I have a ""_plugins/foo.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,5,"I have a ""_plugins/bar.rb"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,9,"I should see ""Deprecation: Document#title"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,10,"I should see ""_plugins/foo.rb:2"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,11,"I should see ""_plugins/bar.rb:3"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_data.feature,Deprecate calling data keys directly via Ruby,12,"I should not see ""lib/jekyll/document.rb"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,1,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt without a layout,7,"I should see exactly ""<p>content for entry1.</p>"" in ""_site/index.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,1,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,4,"I have a post layout that contains ""{{ page.excerpt }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,9,the _site/2007 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,10,the _site/2007/12 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,11,the _site/2007/12/31 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,12,"the ""_site/2007/12/31/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,13,"I should see exactly ""<p>content for entry1.</p>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout,14,"I should see exactly ""<p>content for entry1.</p>"" in ""_site/index.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,1,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,2,"I have a configuration file with ""baseurl"" set to ""/blog""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,3,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,4,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,5,"I have a post layout that contains ""{{ page.excerpt }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,6,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,10,the _site/2007 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,11,the _site/2007/12 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,12,the _site/2007/12/31 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,13,"the ""_site/2007/12/31/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,14,"I should see exactly ""<p>/blog/assets/style.css</p>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt with Liquid constructs from a post with a layout,15,"I should see exactly ""<p>/blog/assets/style.css</p>"" in ""_site/index.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,1,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,4,"I have a post layout that contains ""<html><head></head><body>{{ page.excerpt }}</body></html>""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,9,the _site/2007 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,10,the _site/2007/12 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,11,the _site/2007/12/31 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,12,"the ""_site/2007/12/31/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,13,"I should see ""<p>content for entry1.</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,An excerpt from a post with a layout which has context,14,"I should see ""<html><head></head><body><p>content for entry1.</p>\n</body></html>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,1,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,4,"I have a post layout that contains ""{{ page.excerpt }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,5,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,8,the _site/2017/07/06 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,9,"the ""_site/2017/07/06/unrendered-post.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,10,"the ""_site/2017/07/06/rendered-post.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,11,"I should see ""Liquid is not rendered at {{ page.url }}"" in ""_site/2017/07/06/unrendered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,12,"I should see ""<p>Liquid is rendered at /2017/07/06/rendered-post.html</p>"" in ""_site/2017/07/06/rendered-post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts having 'render_with_liquid' in their front matter,13,"I should see ""<p>Liquid is not rendered at {{ page.url }}</p>\n<p>Liquid is rendered at /2017/07/06/rendered-post.html</p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,2,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.excerpt }}{% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,3,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,4,"I have a post layout that contains ""{{ page.excerpt }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,5,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,6,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,9,"I should not see ""Kramdown warning"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,10,"I should see exactly ""<p>Install Jekyll</p>"" in ""_site/just-text-excerpt.html""","Then(%r!^I should see exactly ""(.*)"" in ""(.*)""$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  expect(file_contents(file).strip).to eq text
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,11,"I should see ""<p>Alpha <sup id=\""fnref:1\"" role=\""doc-noteref\""><a href=\""#fn:1\"" class=\""footnote\"" rel=\""footnote\"">1</a></sup></p>"" in ""_site/text-and-footnote.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,12,"I should see ""<p>Omega sigma<a href=\""#fnref:1\"" class=\""reversefootnote\"" role=\""doc-backlink\"">&#8617;</a></p>"" in ""_site/text-and-footnote.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,13,"I should see ""<p>Read <a href=\""docs.jekyll.com\"">docs</a></p>"" in ""_site/text-and-reference-link.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_excerpts.feature,Excerpts from posts with reference-style Markdown links,14,"I should see ""<p>Check out <a href=\""jekyllrb.com\"">jekyll</a></p>"" in ""_site/text-and-self-referencing-link.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,3,"I have an ""index.md"" page that contains ""[Welcome]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,A site that is using the defaults for permalink,7,"I should see ""<p><a href=\""/2019/02/04/hello-world.html\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,3,"I have a configuration file with ""permalink"" set to ""/:title:output_ext""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,4,"I have an ""index.md"" page that contains ""[Welcome]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with site-wide custom permalink setting,8,"I should see ""<p><a href=\""/hello-world.html\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,3,"I have a configuration file with ""permalink"" set to ""/:title:output_ext""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,4,"I have an ""index.md"" page that contains ""[Welcome]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with custom permalink settings on each post,8,"I should see ""<p><a href=\""/2019/hello-world/\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with no posts,1,"I have an ""index.md"" page that contains ""[Welcome]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with no posts,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with no posts,3,I should get a non-zero exit status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
post_url_tag.feature,Site with no posts,4,the _site directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with no posts,5,"I should see ""Could not find post \""2019-02-04-hello-world\"" in tag 'post_url'."" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,3,"I have a configuration file with ""permalink"" set to ""/:title:output_ext""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,4,"I have an ""index.md"" page that contains ""[Welcome Again]({% post_url 2119-02-04-we-meet-again %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,5,I run jekyll build --future,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with a future-dated post,8,"I should see ""<p><a href=\""/we-meet-again.html\"">Welcome Again</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,2,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,3,"I have a configuration file with ""baseurl"" set to ""blog""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,4,"I have an ""index.md"" page that contains ""[Welcome]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Site with configured baseurl,8,"I should see ""<p><a href=\""/blog/2019/02/04/hello-world.html\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,3,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,5,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,6,"I have an ""index.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,10,"I should see ""<p><a href=\""/2019/02/04/hello-world.html\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,11,"I should see ""<p><a href=\""/movies/2019/02/05/hello-movies.html\"">Movies</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Posts with categories,12,"I should see ""<p><a href=\""/movies/film/2019/02/06/star-wars.html\"">Film</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,2,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,3,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,4,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,5,"I have an ""index.md"" page with content","Given(%r!^I have an? ""(.*)"" page with content:$!) do |file, text|
  File.write(file, <<~DATA)
    ---
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,9,"I should see ""<p><a href=\""/2019/02/04/hello-world.html\"">Welcome</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Duplicate posts with categories,10,"I should see ""<p><a href=\""/movies/2019/02/04/hello-world.html\"">Movies</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,1,I have a movies/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,2,"I have the following post in ""movies""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,3,"I have an ""index.md"" page that contains ""[Movies]({% post_url 2019-02-04-hello-world %})""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,6,"I should see ""Deprecation: A call to '{% post_url 2019-02-04-hello-world %}' did not match a post"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Deprecated usage to link nested post,8,"I should see ""<p><a href=\""/movies/2019/02/04/hello-world.html\"">Movies</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,1,I have a Cats and Dogs/_posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,2,"I have the following post in ""Cats and Dogs""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,3,I have a _posts/Salt and Pepper directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,4,"I have the following post under ""Salt and Pepper""","Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,5,"I have an ""index.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,8,"I should not see ""Deprecation: A call to '{% post_url"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,10,"I should see ""<p><a href=\""/cats%20and%20dogs/2019/02/04/hello-world.html\"">Post 1</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
post_url_tag.feature,Nested posts in a directory with name containing spaces,11,"I should see ""<p><a href=\""/2019/02/05/hello-again.html\"">Post 2</a></p>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,1,"I have a blank site in ""omega(beta)""","Given(%r!^I have a blank site in ""(.*)""$!) do |path|
  unless File.exist?(path)
    then FileUtils.mkdir_p(path)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,2,"I have an ""omega(beta)/test.md"" page with layout ""simple"" that contains ""Hello World""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,3,I have an omega(beta)/_includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,4,"I have an ""omega(beta)/_includes/head.html"" file that contains ""Snippet""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,5,"I have a configuration file with ""source"" set to ""omega(beta)""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,6,I have an omega(beta)/_layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,7,"I have an ""omega(beta)/_layouts/simple.html"" file that contains ""{% include head.html %}: {{ content }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,8,I run jekyll build --profile,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,10,"I should see ""Snippet: <p>Hello World</p>"" in ""_site/test.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a site with parentheses in its path name,11,"I should see ""_layouts/simple.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving bad Liquid,1,"I have a ""index.html"" page with layout ""simple"" that contains ""{% include invalid.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,When receiving bad Liquid,2,"I have a simple layout that contains ""{{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,When receiving bad Liquid,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving bad Liquid,4,I should get a non-zero exit-status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
rendering.feature,When receiving bad Liquid,5,"I should see ""Liquid Exception"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,2,"I have a ""_includes/invalid.html"" file that contains ""{% INVALID %}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,3,"I have a ""index.html"" page with layout ""simple"" that contains ""{% include invalid.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,4,"I have a simple layout that contains ""{{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,6,I should get a non-zero exit-status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
rendering.feature,When receiving a liquid syntax error in included file,7,"I should see ""Liquid Exception: Liquid syntax error \(.+/invalid\.html line 1\): Unknown tag 'INVALID' included in index\.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,1,I have a _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,2,"I have a ""_includes/invalid.html"" file that contains ""{{ site.title | prepend 'Prepended Text' }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,3,"I have a ""index.html"" page with layout ""simple"" that contains ""{% include invalid.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,4,"I have a simple layout that contains ""{{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,6,I should get a non-zero exit-status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
rendering.feature,When receiving a generic liquid error in included file,7,"I should see ""Liquid Exception: Liquid error \(.+/_includes/invalid\.html line 1\): wrong number of arguments (\(given 1, expected 2\)|\(1 for 2\)) included in index\.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with rogue Liquid constructs,1,"I have a ""index.html"" page with title ""Simple Test"" that contains ""{{ page.title | foobar }}\n\n{{ page.author }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with rogue Liquid constructs,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with rogue Liquid constructs,3,I should get a zero exit-status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with rogue Liquid constructs,4,"I should not see ""Liquid Exception:"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with a non-existent Liquid variable,1,"I have a ""index.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with a non-existent Liquid variable,2,"I have a configuration file with ""title"" set to ""Hello World""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with a non-existent Liquid variable,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with a non-existent Liquid variable,4,I should get a zero exit-status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a default site containing a file with a non-existent Liquid variable,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid variable,1,"I have a ""index.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid variable,2,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid variable,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid variable,4,I should get a non-zero exit-status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid variable,5,"I should see ""Liquid error \(line 3\): undefined variable author in index.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid filter,1,"I have a ""index.html"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid filter,2,"I have a ""_config.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid filter,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid filter,4,I should get a non-zero exit-status,"Then(%r!^I should get a non-zero exit(?:-| )status$!) do
  step %(I should not see ""EXIT STATUS: 0"" in the build output)
end
",step_definitions.rb,ruby
rendering.feature,Rendering a custom site containing a file with a non-existent Liquid filter,5,"I should see ""Liquid error \(line 3\): undefined filter foobar in index.html"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,1,"I have a ""index.html"" page with layout ""simple"" that contains ""Hi there, Jekyll {{ jekyll.environment }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,2,"I have a simple layout that contains ""{{ content }}Ahoy, indeed!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Render Liquid and place in layout,6,"I should see ""Hi there, Jekyll development!\nAhoy, indeed"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,1,"I have an ""index.scss"" page with layout ""simple"" that contains "".foo-bar { color:black; }""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,2,"I have an ""index.coffee"" page with layout ""simple"" that contains ""whatever()""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,3,"I have a configuration file with ""plugins"" set to ""[jekyll-coffeescript]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,4,"I have a simple layout that contains ""{{ content }}Ahoy, indeed!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,8,"I should not see ""Ahoy, indeed!"" in ""_site/index.css""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place asset files in layout,9,"I should not see ""Ahoy, indeed!"" in ""_site/index.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',1,"I have a ""index.md"" page with layout ""none"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',2,I have a _trials directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',3,"I have a ""_trials/no-layout.md"" page with layout ""none"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',4,"I have a ""_trials/test.md"" page with layout ""null"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',5,"I have a none layout that contains ""{{ content }}Welcome!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',6,"I have a page layout that contains ""{{ content }}Check this out!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',7,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',11,"I should not see ""Welcome!"" in ""_site/trials/no-layout.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',12,"I should not see ""Check this out!"" in ""_site/trials/no-layout.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',13,"I should see ""Check this out!"" in ""_site/trials/test.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',14,"I should see ""Hi there, John Doe!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',15,"I should not see ""Welcome!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Ignore defaults and don't place pages and documents with layout set to 'none',16,"I should not see ""Build Warning:"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',1,"I have a ""index.md"" page with layout ""none"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',2,I have a _trials directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',3,"I have a ""_trials/no-layout.md"" page with layout ""none"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',4,"I have a ""_trials/test.md"" page with layout ""page"" that contains ""Hi there, {{ site.author }}!""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',5,"I have a none layout that contains ""{{ content }}Welcome!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',6,"I have a page layout that contains ""{{ content }}Check this out!""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',7,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',11,"I should not see ""Welcome!"" in ""_site/trials/no-layout.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',12,"I should not see ""Welcome!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',13,"I should see ""Check this out!"" in ""_site/trials/test.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',14,"I should see ""Hi there, John Doe!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Don't place pages and documents with layout set to 'none',15,"I should not see ""Build Warning:"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,1,"I have an ""index.scss"" page that contains "".foo-bar { color:{{site.color}}; }""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,2,"I have a configuration file with ""color"" set to ""red""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in Sass,6,"I should see "".foo-bar {\n  color: red;\n}\n\n\/\*# sourceMappingURL=index.css.map \*\/"" in ""_site/index.css""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Not render liquid in CoffeeScript without explicitly including jekyll-coffeescript,1,"I have an ""index.coffee"" page with animal ""cicada"" that contains ""hey='for {{page.animal}}'""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Not render liquid in CoffeeScript without explicitly including jekyll-coffeescript,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Not render liquid in CoffeeScript without explicitly including jekyll-coffeescript,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Not render liquid in CoffeeScript without explicitly including jekyll-coffeescript,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Not render liquid in CoffeeScript without explicitly including jekyll-coffeescript,5,"the ""_site/index.js"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,1,"I have an ""index.coffee"" page with animal ""cicada"" that contains ""hey='for {{page.animal}}'""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,2,"I have a configuration file with ""plugins"" set to ""[jekyll-coffeescript]""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Render liquid in CoffeeScript with jekyll-coffeescript enabled,6,"I should see ""hey = 'for cicada';"" in ""_site/index.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,1,"I have an ""index.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,2,"I have a configuration file with ""novel"" set to ""'{{ site.title }}'""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,5,"I should see ""series named {{ site.title }}"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,6,"I should see ""{% link series/first-part.md %}"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Rendering Liquid expressions that return strings containing Liquid expressions,7,"I should see ""{% link series/last-part.md %}"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,1,"I have an ""index.md"" page that contains ""__Hello World__""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,2,"I have an ""about.md"" page that contains ""{{ page.name }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,3,"I have a ""test.json"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,7,"I should not see ""content\"": \""{{ page.name }}"" in ""_site/test.json""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,8,"I should not see ""content\"": \""__Hello World__"" in ""_site/test.json""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,9,"I should see ""content\"": \""<p>about.md</p>"" in ""_site/test.json""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
rendering.feature,Render content of another page,10,"I should see ""content\"": \""<p><strong>Hello World</strong></p>"" in ""_site/test.json""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,1,"I have a blank site in ""_sourcedir""","Given(%r!^I have a blank site in ""(.*)""$!) do |path|
  unless File.exist?(path)
    then FileUtils.mkdir_p(path)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,2,"I have an ""_sourcedir/index.html"" file that contains ""Changing source directory""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,3,"I have a configuration file with ""source"" set to ""_sourcedir""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change source directory,7,"I should see ""Changing source directory"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change destination directory,1,"I have an ""index.html"" file that contains ""Changing destination directory""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Change destination directory,2,"I have a configuration file with ""destination"" set to ""_mysite""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Change destination directory,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change destination directory,4,the _mysite directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Change destination directory,5,"I should see ""Changing destination directory"" in ""_mysite/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,1,"I have a blank site in ""<source>""","Given(%r!^I have a blank site in ""(.*)""$!) do |path|
  unless File.exist?(path)
    then FileUtils.mkdir_p(path)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,2,"I have an ""<source>/index.md"" page that contains ""markdown""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,3,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,5,the <source> directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,6,"the ""<dest>/index.html"" file should <file_exist> exist",,step_definitions.rb,ruby
site_configuration.feature,Similarly named source and destination,7,"I should see ""markdown"" in ""<source>/index.md""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,1,"I have an ""Rakefile"" file that contains ""I want to be excluded""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,2,"I have an ""README"" file that contains ""I want to be excluded""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,3,"I have an ""index.html"" file that contains ""I want to be included""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,4,"I have a ""Gemfile"" file that contains ""gem 'include-me'""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,5,"I have a configuration file with ""exclude"" set to ""['Rakefile', 'README']""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,7,"I should see ""I want to be included"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,8,"the ""_site/Gemfile"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,9,"the ""_site/Rakefile"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files inline,10,"the ""_site/README"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,1,"I have an ""Rakefile"" file that contains ""I want to be excluded""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,2,"I have an ""README"" file that contains ""I want to be excluded""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,3,"I have an ""index.html"" file that contains ""I want to be included""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,4,"I have a ""Gemfile"" file that contains ""gem 'include-me'""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,5,"I have a configuration file with ""exclude"" set to","Given(%r!^I have a configuration file with ""([^\""]*)"" set to:$!) do |key, table|
  File.open(""_config.yml"", ""w"") do |f|
    f.write(""#{key}:\n"")
    table.hashes.each do |row|
      f.write(""- #{row[""value""]}\n"")
    end
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,7,"I should see ""I want to be included"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,8,"the ""_site/Rakefile"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,9,"the ""_site/README"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Exclude files with YAML array,10,"the ""_site/Gemfile"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,1,"I have a "".gitignore"" file that contains "".DS_Store""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,2,"I have an "".htaccess"" file that contains ""SomeDirective""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,3,"I have a ""Gemfile"" file that contains ""gem 'include-me'""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,4,I have a node_modules directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,5,"I have a ""node_modules/bazinga.js"" file that contains ""var c = 'Bazinga!';""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,6,"I have a ""node_modules/warning.js"" file that contains ""var w = 'Winter is coming!';""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,7,"I have a configuration file with ""include"" set to","Given(%r!^I have a configuration file with ""([^\""]*)"" set to:$!) do |key, table|
  File.open(""_config.yml"", ""w"") do |f|
    f.write(""#{key}:\n"")
    table.hashes.each do |row|
      f.write(""- #{row[""value""]}\n"")
    end
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,11,"the ""_site/.htaccess"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,12,"I should see "".DS_Store"" in ""_site/.gitignore""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,13,"I should see ""gem 'include-me'"" in ""_site/Gemfile""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,14,"I should see ""var c = 'Bazinga!';"" in ""_site/node_modules/bazinga.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files when their directory is explicitly included,15,"I should see ""var w = 'Winter is coming!';"" in ""_site/node_modules/warning.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,1,"I have a "".gitignore"" file that contains "".DS_Store""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,2,"I have an "".htaccess"" file that contains ""SomeDirective""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,3,I have a node_modules directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,4,"I have a ""node_modules/bazinga.js"" file that contains ""var c = 'Bazinga!';""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,5,"I have a ""node_modules/warning.js"" file that contains ""var w = 'Winter is coming!';""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,6,"I have a configuration file with ""include"" set to","Given(%r!^I have a configuration file with ""([^\""]*)"" set to:$!) do |key, table|
  File.open(""_config.yml"", ""w"") do |f|
    f.write(""#{key}:\n"")
    table.hashes.each do |row|
      f.write(""- #{row[""value""]}\n"")
    end
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,10,"the ""_site/.htaccess"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,11,"I should see "".DS_Store"" in ""_site/.gitignore""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,12,"I should see ""var c = 'Bazinga!';"" in ""_site/node_modules/bazinga.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded files only when they are explicitly included,13,"the ""_site/node_modules/warning.js"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,1,"I have a "".gitignore"" file that contains "".DS_Store""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,2,"I have an "".htaccess"" file that contains ""SomeDirective""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,3,"I have an ""foo.txt"" file that contains ""Lorem Ipsum""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,4,"I have an ""index.md"" page that contains ""{{ site.title }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,5,"I have an ""about.md"" page that contains ""{{ site.author }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,6,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,7,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,8,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,9,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,10,"the ""_site/.gitignore"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,11,"the ""_site/foo.txt"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,12,"the ""_site/index.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,13,"the ""_site/about.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,14,"the ""_site/.htaccess"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,15,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,16,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,17,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,18,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,19,"the ""_site/.gitignore"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,20,"the ""_site/foo.txt"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,21,"the ""_site/index.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,22,"the ""_site/.htaccess"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,23,"the ""_site/about.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Copy over excluded wild-card files only when they are explicitly included,24,"I should see ""John Doe"" in ""_site/about.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,1,"I have a "".foobar"" page that contains ""dotfile with front matter""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,2,"I have an "".htaccess"" file that contains ""SomeDirective""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,3,"I have a ""_redirects"" file that contains ""/foo/* /bar/* 301!""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,4,"I have an ""index.md"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,5,"I have a configuration file with ""title"" set to ""Hello World""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,9,"the ""_site/.foobar"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,10,"the ""_site/_redirects"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,11,"I should see ""Dotpages: 0"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,12,"I should see ""Dotstatics: 0"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,13,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,14,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,15,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,16,"I should not see ""Conflict:"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,17,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,18,"the ""_site/.foobar"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,19,"the ""_site/_redirects"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,20,"I should see ""Dotpages: 1"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Process included files only once,21,"I should see ""Dotstatics: 1"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,1,"I have an ""index.markdown"" page that contains ""[Google](https://www.google.com)""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,2,"I have a configuration file with ""markdown"" set to ""kramdown""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Use Kramdown for markup,6,"I should see ""<a href=\""https://www.google.com\"">Google</a>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,1,"I have an ""index.html"" page that contains ""{% highlight ruby %} puts 'Hello world!' {% endhighlight %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,2,"I have a configuration file with ""highlighter"" set to ""rouge""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,6,"I should see ""Hello world!"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Highlight code with rouge,7,"I should see ""class=\""highlight\"""" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Rouge renders code block once,1,"I have a configuration file with ""highlighter"" set to ""rouge""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_configuration.feature,Rouge renders code block once,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Rouge renders code block once,3,I have the following post,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Rouge renders code block once,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Rouge renders code block once,5,"I should not see ""highlight(.*)highlight"" in ""_site/2014/04/27/foo.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,2,"I have a page layout that contains ""Page Layout: {{ site.posts.size }} on {{ site.time | date: ""%Y-%m-%d"" }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,3,"I have a post layout that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,11,"I should see ""Page Layout: 1 on 2010-01-01"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,12,"I should see ""Post Layout: <p>content for entry1.</p>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and no future dated posts,13,"the ""_site/2020/01/31/entry2.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,2,"I have a page layout that contains ""Page Layout: {{ site.posts.size }} on {{ site.time | date: ""%Y-%m-%d"" }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,3,"I have a post layout that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,11,"I should see ""Page Layout: 2 on 2010-01-01"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,12,"I should see ""Post Layout: <p>content for entry1.</p>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Set time and future dated posts allowed,13,"I should see ""Post Layout: <p>content for entry2.</p>"" in ""_site/2020/01/31/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),2,"I have a page layout that contains ""Page Layout: {{ site.posts.size }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),3,"I have a post layout that contains ""Post Layout: {{ content }} built at {{ page.date | date_to_xmlschema }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),11,"I should see ""Page Layout: 2"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),12,"I should see ""Post Layout: <p>content for entry1.</p>\n built at"" in ""_site/2013/04/09/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),13,"I should see ""Post Layout: <p>content for entry2.</p>\n built at"" in ""_site/2013/04/10/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),14,"I should see date ""2013-04-09T23:22:00-04:00"" in ""_site/2013/04/09/entry1.html"" unless Windows","Then(%r!^I should see date ""(.*)"" in ""(.*)"" unless Windows$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text)
  if Jekyll::Utils::Platforms.really_windows? && !dst_active?
    expect(file_contents(file)).not_to match regexp
  else
    expect(file_contents(file)).to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),15,"I should see date ""2013-04-09T22:22:00-05:00"" in ""_site/2013/04/09/entry1.html"" if on Windows","Then(%r!^I should see date ""(.*)"" in ""(.*)"" if on Windows$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text)
  if Jekyll::Utils::Platforms.really_windows? && !dst_active?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),16,"I should see date ""2013-04-10T03:14:00-04:00"" in ""_site/2013/04/10/entry2.html"" unless Windows","Then(%r!^I should see date ""(.*)"" in ""(.*)"" unless Windows$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text)
  if Jekyll::Utils::Platforms.really_windows? && !dst_active?
    expect(file_contents(file)).not_to match regexp
  else
    expect(file_contents(file)).to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (same as posts' time),17,"I should see date ""2013-04-10T02:14:00-05:00"" in ""_site/2013/04/10/entry2.html"" if on Windows","Then(%r!^I should see date ""(.*)"" in ""(.*)"" if on Windows$!) do |text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text)
  if Jekyll::Utils::Platforms.really_windows? && !dst_active?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),2,"I have a page layout that contains ""Page Layout: {{ site.posts.size }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),3,"I have a post layout that contains ""Post Layout: {{ content }} built at {{ page.date | date_to_xmlschema }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),11,"I should see ""Page Layout: 2"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),12,"the ""_site/2013/04/09/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),13,"the ""_site/2013/04/09/entry2.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),14,"I should see ""Post Layout: <p>content for entry1.</p>\n built at 2013-04-09T09:22:00-10:00"" in ""_site/2013/04/09/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (different than posts' time),15,"I should see ""Post Layout: <p>content for entry2.</p>\n built at 2013-04-09T13:14:00-10:00"" in ""_site/2013/04/09/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),1,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),2,"I have a page layout that contains ""Page Layout: {{ site.posts.size }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),3,"I have a post layout that contains ""Post Layout: {{ content }} built at {{ page.date | date_to_xmlschema }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),11,"I should see ""Page Layout: 2"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),12,"the ""_site/2013/04/10/entry1.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),13,"the ""_site/2013/04/10/entry2.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),14,"I should see ""Post Layout: <p>content for entry1.</p>\n built at 2013-04-10T04:07:00\+08:45"" in ""_site/2013/04/10/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Generate proper dates with explicitly set timezone (using non-half hour offset ),15,"I should see ""Post Layout: <p>content for entry2.</p>\n built at 2013-04-10T07:59:00\+08:45"" in ""_site/2013/04/10/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,2,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,7,"the ""_site/2009/04/05/bananas.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,8,"the ""_site/2009/04/01/oranges.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Limit the number of posts generated by most recent date,9,"the ""_site/2009/03/27/apples.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,1,I have a _theme directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,2,"I have a page theme that contains ""Page Layout: {{ site.posts.size }} on {{ site.time | date: ""%Y-%m-%d"" }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,3,"I have a post theme that contains ""Post Layout: {{ content }}""","Given(%r!^I have an? (.*) (layout|theme) that contains ""(.*)""$!) do |name, type, text|
  folder = type == ""layout"" ? ""_layouts"" : ""_theme""

  destination_file = Pathname.new(File.join(folder, ""#{name}.html""))
  FileUtils.mkdir_p(destination_file.parent) unless destination_file.parent.directory?
  File.write(destination_file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,4,"I have an ""index.html"" page with layout ""page"" that contains ""site index page""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,5,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,6,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,7,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,11,"I should see ""Page Layout: 2 on 2010-01-01"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,12,"I should see ""Post Layout: <p>content for entry1.</p>"" in ""_site/2007/12/31/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,Using a different layouts directory,13,"I should see ""Post Layout: <p>content for entry2.</p>"" in ""_site/2020/01/31/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,1,"I have an ""index.html"" page with layout ""page"" that contains ""FOO""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,2,"I have a ""_config.yml"" file that contains ""layouts: '../../../../../../../../../../../../../../usr/include'""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,6,"I should see ""FOO"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_configuration.feature,arbitrary file reads via layouts,7,"I should not see "" "" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page variable in a page,1,"I have an ""contact.html"" page with title ""Contact"" that contains ""{{ page.title }}: email@example.com""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use page variable in a page,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page variable in a page,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use page variable in a page,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page variable in a page,5,"I should see ""Contact: email@example.com"" in ""_site/contact.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,1,I have a <dir> directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,2,"I have a ""<path>"" page that contains ""Source path: {{ page.path }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use page.path variable in a page,6,"I should see ""Source path: <path>"" in ""_site/<path>""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Override page.path,1,"I have an ""override.html"" page with path ""custom-override.html"" that contains ""Custom path: {{ page.path }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Override page.path,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Override page.path,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Override page.path,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Override page.path,5,"I should see ""Custom path: custom-override.html"" in ""_site/override.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.time variable,1,"I have an ""index.html"" page that contains ""{{ site.time }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use site.time variable,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.time variable,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use site.time variable,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.time variable,5,"I should see today's time in ""_site/index.html""","Then(%r!^I should see today's time in ""(.*)""$!) do |file|
  step %(I should see ""#{seconds_agnostic_time(Time.now)}"" in ""#{file}"")
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,2,"I have an ""index.html"" page that contains ""{{ site.posts.first.title }}: {{ site.posts.first.url }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable for latest post,7,"I should see ""Third Post: /2009/03/27/third-post.html"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,2,"I have an ""index.html"" page that contains ""{% for post in site.posts %} {{ post.title }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.posts variable in a loop,7,"I should see ""Third Post  Second Post  First Post"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,2,"I have an ""index.html"" page that contains ""{% for post in site.categories.code %} {{ post.title }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.categories.code variable,7,"I should see ""Awesome Hack"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,2,"I have an ""index.html"" page that contains ""{% for post in site.tags.beer %} {{ post.content }} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use site.tags variable,7,"I should see ""Yuengling"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,1,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,2,"I have an ""index.html"" page that contains ""{% for post in site.posts %}{{ post.title }}:{{ post.previous.title}},{{ post.next.title}} {% endfor %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Order Posts by name when on the same date,7,"I should see ""last:C, C:B,last B:A,C A:first,B first:,A"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,1,"I have an ""index.html"" page that contains ""{{ site.url }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,2,"I have a configuration file with ""url"" set to ""http://example.com""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Use configuration date in site payload,6,"I should see ""http://example.com"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
site_data.feature,Access Jekyll version via jekyll.version,1,"I have an ""index.html"" page that contains ""{{ jekyll.version }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
site_data.feature,Access Jekyll version via jekyll.version,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
site_data.feature,Access Jekyll version via jekyll.version,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
site_data.feature,Access Jekyll version via jekyll.version,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
site_data.feature,Access Jekyll version via jekyll.version,5,"I should see ""\d+\.\d+\.\d+"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold,1,I run jekyll new-theme my-cool-theme,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold,2,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold,3,the my-cool-theme directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold with a code of conduct,1,I run jekyll new-theme my-cool-theme --code-of-conduct,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold with a code of conduct,2,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold with a code of conduct,3,the my-cool-theme directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Generating a new theme scaffold with a code of conduct,4,"the ""my-cool-theme/CODE_OF_CONDUCT.md"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with SCSS,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with SCSS,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with SCSS,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with SCSS,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with SCSS,5,"I should see "".sample {\n  color: red;\n}\n\n\/\*# sourceMappingURL=style.css.map \*\/"" in ""_site/assets/style.css""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,2,I have an assets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,3,"I have an ""assets/style.scss"" page that contains ""@import 'test-theme-black';""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,4,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,5,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,6,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Overriding a theme with SCSS,7,"I should see "".sample {\n  color: black;\n}\n\n\/\*# sourceMappingURL=style.css.map \*\/"" in ""_site/assets/style.css""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,2,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,3,"I have an ""_includes/in_project.html"" file that contains ""I'm in the project.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,4,"I have an ""index.html"" page that contains ""{% include in_project.html %} {% include include.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,8,"I should see ""I'm in the project."" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with an include,9,"I should see ""<span class=\""sample\"">include.html from test-theme</span>"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme without data,1,"I have a configuration file with ""theme"" set to ""test-theme-skinny""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme without data,2,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme without data,3,"I have a ""_data/greetings.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme without data,4,"I have an ""index.html"" page that contains ""{{ site.data.greetings.foo }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme without data,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme without data,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme without data,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme without data,8,"I should see ""Hello! Im foo. And who are you?"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,2,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,3,"I have a ""_data/greetings.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,4,"I have an ""index.html"" page that contains ""{{ site.data.greetings.foo }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,8,"I should see ""Hello! Im foo. And who are you?"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with data overridden by data in source directory,9,"I should not see ""Hello! Im bar. Whats up so far?"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,2,I have an _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,3,"I have an ""_layouts/post.html"" file that contains ""post.html from the project: {{ content }}""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,4,"I have an ""index.html"" page with layout ""default"" that contains ""I'm content.""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,5,"I have a ""post.html"" page with layout ""post"" that contains ""I'm more content.""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,6,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,7,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,8,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,9,"I should see ""default.html from test-theme: I'm content."" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with a layout,10,"I should see ""post.html from the project: I'm more content."" in ""_site/post.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,2,I have an assets directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,3,"I have an ""assets/application.coffee"" file that contains ""From your site.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,4,"I have an ""assets/base.js"" file that contains ""From your site.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,8,"I should see ""From your site."" in ""_site/assets/application.coffee""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with assets,9,"I should see ""From your site."" in ""_site/assets/base.js""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,1,"I have a configuration file with ""theme"" set to ""test-theme-skinny""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,2,"I have an ""index.html"" page with layout ""home"" that contains ""The quick brown fox.""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,6,"I should see ""Message: The quick brown fox."" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,7,"I should not see ""_includes"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,8,"I should not see ""_sass"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
theme.feature,A theme with *just* layouts,9,"I should not see ""assets"" in the build output","Then(%r!^I should (not )?see ""(.*)"" in the build output$!) do |negative, text|
  if negative.nil? || negative.empty?
    expect(jekyll_run_output).to match Regexp.new(text)
  else
    expect(jekyll_run_output).not_to match Regexp.new(text)
  end
end

",step_definitions.rb,ruby
theme.feature,Requiring dependencies of a theme,1,"I have a configuration file with ""theme"" set to ""test-dependency-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,Requiring dependencies of a theme,2,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Requiring dependencies of a theme,3,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Requiring dependencies of a theme,4,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Requiring dependencies of a theme,5,"the ""_site/test.txt"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,2,I have a _posts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,3,I have the following posts,"Given(%r!^I have the following (draft|page|post)s?(?: (in|under) ""([^""]+)"")?:$!) do |status, direction, folder, table|
  table.hashes.each do |input_hash|
    title = slug(input_hash[""title""])
    ext = input_hash[""type""] || ""markdown""
    filename = ""#{title}.#{ext}"" if %w(draft page).include?(status)
    before, after = location(folder, direction)
    dest_folder = ""_drafts"" if status == ""draft""
    dest_folder = ""_posts""  if status == ""post""
    dest_folder = """" if status == ""page""

    if status == ""post""
      parsed_date = Time.xmlschema(input_hash[""date""]) rescue Time.parse(input_hash[""date""])
      input_hash[""date""] = parsed_date
      filename = ""#{parsed_date.strftime(""%Y-%m-%d"")}-#{title}.#{ext}""
    end

    path = File.join(before, dest_folder, after, filename)
    File.write(path, file_content_from_hash(input_hash))
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,4,I have a _layouts directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,5,"I have a ""_layouts/post.html"" page with layout ""default"" that contains ""I am a post layout! {{ content }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,6,I have an _includes directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,7,"I have an ""_includes/in_project.html"" file that contains ""I am in the project, not the theme.""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,8,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,9,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,10,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,11,"I should see ""I am in the project, not the theme."" in ""_site/2016/04/21/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,12,"I should see ""<span class=\""sample\"">include.html from test-theme</span>"" in ""_site/2016/04/21/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,13,"I should see ""default.html from test-theme:"" in ""_site/2016/04/21/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,14,"I should see ""I am using a themed layout."" in ""_site/2016/04/21/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,15,"I should not see ""I am a post layout!"" in ""_site/2016/04/21/entry2.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,16,"I should not see ""I am in the project, not the theme."" in ""_site/2016/04/21/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,17,"I should see ""<span class=\""sample\"">include.html from test-theme</span>"" in ""_site/2016/04/21/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,18,"I should see ""default.html from test-theme:"" in ""_site/2016/04/21/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,19,"I should see ""I am using a local layout."" in ""_site/2016/04/21/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together,20,"I should see ""I am a post layout!"" in ""_site/2016/04/21/entry1.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,2,I have a _data directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,3,"I have a ""_data/i18n.yml"" file with content","Given(%r!^I have an? ""(.*)"" file with content:$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,4,"I have an ""index.html"" page that contains ""{% include testimonials.html %}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,8,"I should not see ""Testimonials"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,9,"I should see ""Kundenstimmen"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme.feature,Complicated site that puts it all together in respect to data folders,10,"I should see ""Design by FTC"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,2,"I have an ""index.md"" page that contains ""{{ site.test_theme.skin }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Easy onboarding with a pre-configured theme,6,"I should see ""aero"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,1,I have a configuration file with,"Given(%r!^I have a configuration file with:$!) do |table|
  table.hashes.each do |row|
    step %(I have a configuration file with ""#{row[""key""]}"" set to ""#{row[""value""]}"")
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,2,"I have an ""index.md"" page that contains ""{{ site.test_theme.skin }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,3,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,4,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,5,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,Disabling import of theme configuration entirely,6,"I should not see ""aero"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,1,"I have a configuration file with ""theme"" set to ""test-theme""","Given(%r!^I have a configuration file with ""(.*)"" set to ""(.*)""$!) do |key, value|
  config = \
    if source_dir.join(""_config.yml"").exist?
      SafeYAML.load_file(source_dir.join(""_config.yml""))
    else
      {}
    end
  config[key] = SafeYAML.load(value)
  Jekyll.set_timezone(value) if key == ""timezone""
  File.write(""_config.yml"", YAML.dump(config))
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,2,"I have an ""index.md"" page that contains ""{{ site.baseurl }}""","Given(%r!^I have an? ""(.*)"" page(?: with (.*) ""(.*)"")? that contains ""(.*)""$!) do |file, key, value, text|
  File.write(file, <<~DATA)
    ---
    #{key || ""layout""}: #{value || ""none""}
    ---

    #{text}
  DATA
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,3,I have a node_modules directory,"Given(%r!^I have an? (.*) directory$!) do |dir|
  unless File.directory?(dir)
    then FileUtils.mkdir_p(dir)
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,4,"I have a ""node_modules/alert.js"" file that contains ""alert('foo');""","Given(%r!^I have an? ""(.*)"" file that contains ""(.*)""$!) do |file, text|
  File.write(file, text)
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,5,I run jekyll build,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,6,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,7,the _site directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,8,"the ""_site/index.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,9,"the ""_site/node_modules/alert.js"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,10,"the ""_site/extras/banner.html"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_configuration.feature,A pre-configured theme with valid config file overriding Jekyll defaults,11,"I should not see ""/test-theme"" in ""_site/index.html""","Then(%r!^I should (not )?see ""(.*)"" in ""(.*)""$!) do |negative, text, file|
  step %(the ""#{file}"" file should exist)
  regexp = Regexp.new(text, Regexp::MULTILINE)
  if negative.nil? || negative.empty?
    expect(file_contents(file)).to match regexp
  else
    expect(file_contents(file)).not_to match regexp
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Generating a new Jekyll Theme,1,I run jekyll new-theme my-cool-theme,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Generating a new Jekyll Theme,2,I should get a zero exit status,"Then(%r!^I should get a zero exit(?:-| )status$!) do
  step %(I should see ""EXIT STATUS: 0"" in the build output)
end

",step_definitions.rb,ruby
theme_gem.feature,Generating a new Jekyll Theme,3,the my-cool-theme directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,1,I run jekyll new-theme my-cool-theme,"When(%r!^I run jekyll(.*)$!) do |args|
  run_jekyll(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,2,the my-cool-theme directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,3,I decide to build the theme gem,"When(%r!^I decide to build the theme gem$!) do
  Dir.chdir(Paths.theme_gem_dir)
  [
    ""_includes/blank.html"",
    ""_sass/blank.scss"",
    ""assets/blank.scss"",
    ""_config.yml""
  ].each do |filename|
    File.new(filename, ""w"")
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,4,"the ""_includes/blank.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,5,"the ""_sass/blank.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,6,"the ""assets/blank.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,7,I run git add .,"When(%r!^I run git add .$!) do
  run_in_shell(""git"", ""add"", ""."", ""--verbose"")
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,8,I should get an updated git index,"Then(%r!^I should get an updated git index$!) do
  index = %w(
    .gitignore
    Gemfile
    LICENSE.txt
    README.md
    _config.yml
    _includes/blank.html
    _layouts/default.html
    _layouts/page.html
    _layouts/post.html
    _sass/blank.scss
    assets/blank.scss
    my-cool-theme.gemspec
  )
  index.each do |file|
    expect(jekyll_run_output).to match file
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,9,I run gem build --force my-cool-theme.gemspec,"When(%r!^I run gem(.*)$!) do |args|
  run_rubygem(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,10,"the ""./my-cool-theme-0.1.0.gem"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,11,I run gem unpack my-cool-theme-0.1.0.gem,"When(%r!^I run gem(.*)$!) do |args|
  run_rubygem(args)
  if args.include?(""--verbose"") || ENV[""DEBUG""]
    warn ""\n#{jekyll_run_output}\n""
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,12,the my-cool-theme-0.1.0 directory should exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,13,"the ""my-cool-theme-0.1.0/_layouts/default.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,14,"the ""my-cool-theme-0.1.0/_includes/blank.html"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,15,"the ""my-cool-theme-0.1.0/_sass/blank.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,16,"the ""my-cool-theme-0.1.0/assets/blank.scss"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,17,"the ""my-cool-theme-0.1.0/_config.yml"" file should exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,18,the my-cool-theme-0.1.0/.git directory should not exist,"Then(%r!^the (.*) directory should +(not )?exist$!) do |dir, negative|
  if negative.nil?
    expect(Pathname.new(dir)).to exist
  else
    expect(Pathname.new(dir)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,19,"the ""my-cool-theme-0.1.0/.gitignore"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,20,"the ""my-cool-theme-0.1.0/Gemfile"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
theme_gem.feature,Checking if a bonafide Theme gem will be built from generated scaffolding,21,"the ""my-cool-theme-0.1.0/my-cool-theme.gemspec"" file should not exist","Then(%r!^the ""(.*)"" file should +(not )?exist$!) do |file, negative|
  if negative.nil?
    expect(Pathname.new(file)).to exist
  else
    expect(Pathname.new(file)).to_not exist
  end
end

",step_definitions.rb,ruby
