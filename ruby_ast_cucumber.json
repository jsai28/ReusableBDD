[
  "begin",
  [
    "block",
    [
      "send",
      null,
      "When",
      [
        "regexp",
        [
          "str",
          "^I run `cucumber{}`'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "args"
        ]
      ]
    ],
    [
      "send",
      null,
      "execute_cucumber",
      [
        "lvar",
        "args"
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "When",
      [
        "regexp",
        [
          "str",
          "^I run `bundle exec ruby {}`'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "filename"
        ]
      ]
    ],
    [
      "send",
      null,
      "execute_ruby",
      [
        "lvar",
        "filename"
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "When",
      [
        "regexp",
        [
          "str",
          "^I run `(bundle exec )rake {word}`'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "task"
        ]
      ]
    ],
    [
      "send",
      null,
      "execute_rake",
      [
        "lvar",
        "task"
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "When",
      [
        "regexp",
        [
          "str",
          "^I run the feature with the progress formatter'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args"
    ],
    [
      "send",
      null,
      "execute_cucumber",
      [
        "str",
        "features/ --format progress"
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the exit status should be {int}'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "exit_code"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          null,
          "command_line"
        ]
      ],
      "to",
      [
        "send",
        null,
        "have_exited_with",
        [
          "lvar",
          "exit_code"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^it should {status}'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "status"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          null,
          "command_line"
        ]
      ],
      "to",
      [
        "send",
        null,
        "have_exited_with",
        [
          "lvar",
          "status"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^it should {status} with:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "arg",
        "status"
      ],
      [
        "arg",
        "output"
      ]
    ],
    [
      "begin",
      [
        "send",
        [
          "send",
          null,
          "expect",
          [
            "send",
            null,
            "command_line"
          ]
        ],
        "to",
        [
          "send",
          null,
          "have_exited_with",
          [
            "lvar",
            "status"
          ]
        ]
      ],
      [
        "send",
        [
          "send",
          null,
          "expect",
          [
            "send",
            [
              "send",
              null,
              "command_line"
            ],
            "all_output"
          ]
        ],
        "to",
        [
          "send",
          null,
          "include_output",
          [
            "lvar",
            "output"
          ]
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^it should {status} with exactly:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "arg",
        "status"
      ],
      [
        "arg",
        "output"
      ]
    ],
    [
      "begin",
      [
        "send",
        [
          "send",
          null,
          "expect",
          [
            "send",
            null,
            "command_line"
          ]
        ],
        "to",
        [
          "send",
          null,
          "have_exited_with",
          [
            "lvar",
            "status"
          ]
        ]
      ],
      [
        "send",
        [
          "send",
          null,
          "expect",
          [
            "send",
            [
              "send",
              null,
              "command_line"
            ],
            "all_output"
          ]
        ],
        "to",
        [
          "send",
          null,
          "be_similar_output_than",
          [
            "lvar",
            "output"
          ]
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the output should contain:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "all_output"
        ]
      ],
      "to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the output should contain {string}'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "all_output"
        ]
      ],
      "to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the output includes the message {string}'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "message"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "all_output"
        ]
      ],
      "to",
      [
        "send",
        null,
        "include",
        [
          "lvar",
          "message"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the output should not contain:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "all_output"
        ]
      ],
      "not_to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the output should not contain {string}'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "all_output"
        ]
      ],
      "not_to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the stdout should contain exactly:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "stdout"
        ]
      ],
      "to",
      [
        "send",
        null,
        "be_similar_output_than",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the stderr should contain:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "stderr"
        ]
      ],
      "to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the stderr should not contain:'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args",
      [
        "procarg0",
        [
          "arg",
          "output"
        ]
      ]
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "stderr"
        ]
      ],
      "not_to",
      [
        "send",
        null,
        "include_output",
        [
          "lvar",
          "output"
        ]
      ]
    ]
  ],
  [
    "block",
    [
      "send",
      null,
      "Then",
      [
        "regexp",
        [
          "str",
          "^the stderr should not contain anything'$"
        ],
        [
          "regopt"
        ]
      ]
    ],
    [
      "args"
    ],
    [
      "send",
      [
        "send",
        null,
        "expect",
        [
          "send",
          [
            "send",
            null,
            "command_line"
          ],
          "stderr"
        ]
      ],
      "to",
      [
        "send",
        null,
        "be_empty"
      ]
    ]
  ]
]